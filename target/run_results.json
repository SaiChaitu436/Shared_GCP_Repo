{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-11-06T07:00:43.650510Z", "invocation_id": "702ed80f-6e92-4de5-9da1-b9610e07681f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-06T07:00:41.157168Z", "completed_at": "2024-11-06T07:00:41.173716Z"}, {"name": "execute", "started_at": "2024-11-06T07:00:41.173716Z", "completed_at": "2024-11-06T07:00:43.631782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.474613666534424, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "de-coe", "job_id": "d861b821-a653-4667-be26-5ef63e5bc073", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp.dim_all_columns", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT\n\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\n\n    FROM\n\n        `de-coe`.`buybox_dataset`.`merge_seed_final_table`\n),\n\nflatten_payload AS (\n\n    SELECT\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\n\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\n\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\n\n    FROM\n\n        source_data\n\n),\n\nflattened_payload AS (\n\n    SELECT\n\n        EventTime,\n\n        ApplicationId,\n\n        NotificationId,\n\n        PublishTime,\n\n        SubscriptionId,\n\n        NotificationType,\n\n        NotificationVersion,\n\n        ASIN,\n\n        ItemCondition,\n\n        MarketplaceId,\n\n        OfferChangeType,\n\n        TimeOfOfferChange,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\n\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\n\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\n\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\n\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\n\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\n\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\n\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\n\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\n\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\n\n    FROM\n\n        flatten_payload,\n\n        UNNEST(offers) AS offer,\n\n        UNNEST(bbp) AS bbp,\n\n        UNNEST(lop) AS lop,\n\n        UNNEST(neo) AS neo,\n\n        UNNEST(noo) AS noo,\n\n        UNNEST(sr) AS sr\n\n)\n\nSELECT \n    EventTime,\n    ApplicationId,\n    NotificationId,\n    PublishTime,\n    SubscriptionId,\n    NotificationType,\n    NotificationVersion,\n    ASIN,\n    ItemCondition,\n    MarketplaceId,\n    OfferChangeType,\n    TimeOfOfferChange,\n    IsBuyBoxWinner,\n    IsFeaturedMerchant,\n    IsFulfilledByAmazon,\n    ListingPriceAmount,\n    ListingPriceCurrencyCode,\n    IsOfferNationalPrime,\n    IsOfferPrime,\n    SellerId,\n    CASE \n        WHEN SellerId = 'A3F2UBJ6MNDDM5' THEN 'MedicalSupplyMI'\n        WHEN SellerId = 'A13NYAASDR0XYP' THEN 'IRONMED'\n        WHEN SellerId = 'A2V74LV9L3ASTD' THEN 'Health & Prime'\n        WHEN SellerId = 'A1AKLLB03VCSY5' THEN 'UrthShop'\n        WHEN SellerId = 'A32YGV37EPHIKJ' THEN 'Boondocks Medical'\n        WHEN SellerId = 'A147ASZ83GESTI' THEN 'Stateside Medical Supply'\n        WHEN SellerId = 'A3MT75038F86CX' THEN 'Johnson Distributors'\n        WHEN SellerId = 'A1G2IX65IQJHUO' THEN 'EXPRESSMED'\n        WHEN SellerId = 'ABOPLAY6RS86X' THEN 'global-wholesale'\n        WHEN SellerId = 'A29OWEYSFJVSZC' THEN 'Healing Easier'\n        WHEN SellerId = 'AFF8XSNGT0QQC' THEN 'Honest Medical'\n        WHEN SellerId = 'A2I0HOF5WGMLJC' THEN 'Social Medical Supply'\n        WHEN SellerId = 'APSAI9VUG3A9O' THEN 'Katy Med Solutions'\n        ELSE 'Unknown Seller'\n    END AS SellerName,\n    SellerFeedbackCount,\n    SellerPositiveFeedbackRating,\n    ShippingAmount,\n    ShippingCurrencyCode,\n    ShippingAvailabilityType,\n    ShippingMaxHours,\n    ShippingMinHours,\n    ShipsDomestically,\n    ShipsFromCountry,\n    ShipsFromState,\n    SubCondition,\n    BuyBoxPricesCondition,\n    BuyBoxLandedPriceAmount,\n    BuyBoxLandedPriceCurrencyCode,\n    BuyBoxListingPriceAmount,\n    BuyBoxListingPriceCurrencyCode,\n    BuyBoxShippingAmount,\n    BuyBoxShippingCurrencyCode,\n    LowestPricesCondition,\n    LowestPricesFulfillmentChannel,\n    LandedPriceAmount,\n    LandedPriceCurrencyCode,\n    LowestPricesListingPriceAmount,\n    LowestPricesListingCurrencyCode,\n    LowestPricesShippingPriceAmount,\n    LowestPricesShippingCurrencyCode,\n    BuyBoxEligibleOffersCondition,\n    BuyBoxEligibleOffersFulfillmentChannel,\n    BuyBoxEligibleOffersCount,\n    NumberOfOffersCondition,\n    NumberOfOffersFulfillmentChannel,\n    NumberOfOffersCount,\n    SalesRankingsProductCategoryId,\n    SalesRankingsRank,\n    ListPriceAmount,\n    ListPriceCurrencyCode\n\nFROM \n    flattened_payload \nORDER BY \n    ASIN", "relation_name": "`de-coe`.`buybox_dataset`.`dim_all_columns`"}], "elapsed_time": 4.9711689949035645, "args": {"favor_state": false, "strict_mode": false, "log_format_file": "debug", "cache_selected_only": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "full_refresh": true, "send_anonymous_usage_stats": true, "empty": false, "log_file_max_bytes": 10485760, "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs", "write_json": true, "log_format": "default", "project_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp", "invocation_command": "dbt run --full-refresh --select dim_all_columns", "print": true, "use_colors_file": true, "version_check": true, "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "exclude": [], "enable_legacy_logger": false, "log_level": "info", "printer_width": 80, "select": ["dim_all_columns"], "macro_debugging": false, "show_resource_report": false, "quiet": false, "static_parser": true, "profiles_dir": "C:\\Users\\SAILS-DM204\\.dbt", "warn_error_options": {"include": [], "exclude": []}, "vars": {}, "log_level_file": "debug", "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "partial_parse": true, "defer": false, "populate_cache": true, "which": "run", "use_colors": true}}