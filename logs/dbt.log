[0m11:08:35.349594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200090267B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020008D5DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200082CECF0>]}


============================== 11:08:35.349594 | 105ebe15-af8d-4899-9c62-27dc2aa644df ==============================
[0m11:08:35.349594 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:08:35.349594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:35.376536 [info ] [MainThread]: dbt version: 1.8.6
[0m11:08:35.376536 [info ] [MainThread]: python version: 3.12.6
[0m11:08:35.376536 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m11:08:35.376536 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m11:08:36.567237 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m11:08:36.567237 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m11:08:36.567237 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp\dbt_project.yml
[0m11:08:36.580559 [info ] [MainThread]: adapter type: bigquery
[0m11:08:36.580559 [info ] [MainThread]: adapter version: 1.8.2
[0m11:08:36.671142 [info ] [MainThread]: Configuration:
[0m11:08:36.672149 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:08:36.673179 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:08:36.673179 [info ] [MainThread]: Required dependencies:
[0m11:08:36.674187 [debug] [MainThread]: Executing "git --help"
[0m11:08:36.715459 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:08:36.715459 [debug] [MainThread]: STDERR: "b''"
[0m11:08:36.715459 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:08:36.715459 [info ] [MainThread]: Connection:
[0m11:08:36.715459 [info ] [MainThread]:   method: service-account
[0m11:08:36.715459 [info ] [MainThread]:   database: dbt-437212
[0m11:08:36.715459 [info ] [MainThread]:   execution_project: dbt-437212
[0m11:08:36.715459 [info ] [MainThread]:   schema: wellbefore
[0m11:08:36.715459 [info ] [MainThread]:   location: US
[0m11:08:36.715459 [info ] [MainThread]:   priority: interactive
[0m11:08:36.715459 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:08:36.715459 [info ] [MainThread]:   impersonate_service_account: None
[0m11:08:36.730265 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:08:36.731275 [info ] [MainThread]:   job_retries: 1
[0m11:08:36.731275 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:08:36.732274 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m11:08:36.733571 [info ] [MainThread]:   timeout_seconds: 300
[0m11:08:36.733571 [info ] [MainThread]:   client_id: None
[0m11:08:36.733571 [info ] [MainThread]:   token_uri: None
[0m11:08:36.733571 [info ] [MainThread]:   dataproc_region: None
[0m11:08:36.733571 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:08:36.733571 [info ] [MainThread]:   gcs_bucket: None
[0m11:08:36.733571 [info ] [MainThread]:   dataproc_batch: None
[0m11:08:36.733571 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:08:36.733571 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:08:36.733571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:36.733571 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 22] Invalid argument: '"C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Junk Folder\\DBT\\dbt-437212-d8b5c64d8b36.json"''
[0m11:08:36.733571 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:08:36.733571 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:08:36.733571 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 22] Invalid argument: '"C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Junk Folder\\DBT\\dbt-437212-d8b5c64d8b36.json"'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:08:36.733571 [debug] [MainThread]: Command `dbt debug` failed at 11:08:36.733571 after 1.58 seconds
[0m11:08:36.733571 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:08:36.733571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200090267B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001C852990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001C7A1610>]}
[0m11:08:36.747167 [debug] [MainThread]: Flushing usage events
[0m11:14:26.809663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7325B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF75B91E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6FB75520>]}


============================== 11:14:26.809663 | 2f803a7a-c717-465f-a64a-338177dd5a14 ==============================
[0m11:14:26.809663 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:14:26.809663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:26.827517 [info ] [MainThread]: dbt version: 1.8.6
[0m11:14:26.827517 [info ] [MainThread]: python version: 3.12.6
[0m11:14:26.827517 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m11:14:26.827517 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m11:14:28.087339 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m11:14:28.089552 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m11:14:28.089552 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp\dbt_project.yml
[0m11:14:28.089552 [info ] [MainThread]: adapter type: bigquery
[0m11:14:28.089552 [info ] [MainThread]: adapter version: 1.8.2
[0m11:14:28.180952 [info ] [MainThread]: Configuration:
[0m11:14:28.181968 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:14:28.182966 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:14:28.182966 [info ] [MainThread]: Required dependencies:
[0m11:14:28.184065 [debug] [MainThread]: Executing "git --help"
[0m11:14:28.225653 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:14:28.225653 [debug] [MainThread]: STDERR: "b''"
[0m11:14:28.225653 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:14:28.225653 [info ] [MainThread]: Connection:
[0m11:14:28.225653 [info ] [MainThread]:   method: service-account
[0m11:14:28.225653 [info ] [MainThread]:   database: dbt-437212
[0m11:14:28.225653 [info ] [MainThread]:   execution_project: dbt-437212
[0m11:14:28.225653 [info ] [MainThread]:   schema: wellbefore
[0m11:14:28.225653 [info ] [MainThread]:   location: US
[0m11:14:28.225653 [info ] [MainThread]:   priority: interactive
[0m11:14:28.225653 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:14:28.225653 [info ] [MainThread]:   impersonate_service_account: None
[0m11:14:28.238216 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:14:28.239228 [info ] [MainThread]:   job_retries: 1
[0m11:14:28.239228 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:14:28.239228 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m11:14:28.239228 [info ] [MainThread]:   timeout_seconds: 300
[0m11:14:28.239228 [info ] [MainThread]:   client_id: None
[0m11:14:28.239228 [info ] [MainThread]:   token_uri: None
[0m11:14:28.239228 [info ] [MainThread]:   dataproc_region: None
[0m11:14:28.239228 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:14:28.239228 [info ] [MainThread]:   gcs_bucket: None
[0m11:14:28.239228 [info ] [MainThread]:   dataproc_batch: None
[0m11:14:28.239228 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:14:28.239228 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:14:28.239228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:28.289440 [debug] [MainThread]: On debug: select 1 as id
[0m11:14:30.022313 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:d281b4c7-547b-4b19-8f05-1a31668103e8&page=queryresults
[0m11:14:30.932329 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:14:30.932329 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:14:30.932329 [debug] [MainThread]: Command `dbt debug` succeeded at 11:14:30.932329 after 4.31 seconds
[0m11:14:30.932329 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:14:30.932329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF759A5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF75CBFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF74E5A180>]}
[0m11:14:30.932329 [debug] [MainThread]: Flushing usage events
[0m11:37:33.094887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E60B54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E8D98110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E8F82570>]}


============================== 11:37:33.094887 | 01ab87f7-e4e5-432c-9206-cb722d9fbf80 ==============================
[0m11:37:33.094887 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:37:33.094887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m11:37:34.535277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01ab87f7-e4e5-432c-9206-cb722d9fbf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E8B7A810>]}
[0m11:37:34.583356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01ab87f7-e4e5-432c-9206-cb722d9fbf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FBC93560>]}
[0m11:37:34.583356 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:37:34.600254 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:37:34.600254 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:37:34.600254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01ab87f7-e4e5-432c-9206-cb722d9fbf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FC52F5C0>]}
[0m11:37:36.323127 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp.src_hello' (models\src\src_hello.sql) depends on a source named 'dbt-cloud-01.BB_Raw_data' which was not found
[0m11:37:36.323127 [debug] [MainThread]: Command `dbt seed` failed at 11:37:36.323127 after 3.41 seconds
[0m11:37:36.323127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E8D98110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FC65E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FCA5C050>]}
[0m11:37:36.338750 [debug] [MainThread]: Flushing usage events
[0m11:38:06.230043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BD8DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BD8C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378B42DE80>]}


============================== 11:38:06.230043 | a21dbf74-ebfe-411f-9b63-02561fdb4b7a ==============================
[0m11:38:06.230043 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:38:06.230043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:07.638835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023789942900>]}
[0m11:38:07.692629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379EA02570>]}
[0m11:38:07.692629 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:38:07.704740 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:38:07.704740 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:38:07.704740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F4E8F80>]}
[0m11:38:08.546059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.buy_box_gcp.example
[0m11:38:08.546059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F836060>]}
[0m11:38:08.649493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F838C20>]}
[0m11:38:08.650515 [info ] [MainThread]: Found 1 seed, 478 macros
[0m11:38:08.651396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F7C8920>]}
[0m11:38:08.652398 [info ] [MainThread]: 
[0m11:38:08.653794 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:38:08.654950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:38:08.654950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:10.146161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:38:10.146161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:11.417566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002379F7C0470>]}
[0m11:38:11.417566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:11.417566 [info ] [MainThread]: 
[0m11:38:11.438092 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m11:38:11.438092 [info ] [Thread-1 (]: 1 of 1 START seed file wellbefore.BuyBox_raw_ds_first20_entries ................ [RUN]
[0m11:38:11.444598 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.buy_box_gcp.BuyBox_raw_ds_first20_entries'
[0m11:38:11.446051 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m11:38:11.446051 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m11:38:11.496686 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:18.003240 [debug] [Thread-1 (]: On seed.buy_box_gcp.BuyBox_raw_ds_first20_entries: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "seed.buy_box_gcp.BuyBox_raw_ds_first20_entries"} */

    alter table `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()
  
[0m11:38:18.552248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:e1c71c6e-21da-4194-ac64-44b5e31feaf4&page=queryresults
[0m11:38:19.368176 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp.BuyBox_raw_ds_first20_entries"
[0m11:38:19.388341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21dbf74-ebfe-411f-9b63-02561fdb4b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237899418E0>]}
[0m11:38:19.388341 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries ............ [[32mINSERT 20[0m in 7.94s]
[0m11:38:19.388341 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m11:38:19.388341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:19.388341 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:38:19.388341 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:38:19.388341 [debug] [MainThread]: Connection 'seed.buy_box_gcp.BuyBox_raw_ds_first20_entries' was properly closed.
[0m11:38:19.388341 [info ] [MainThread]: 
[0m11:38:19.388341 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m11:38:19.388341 [debug] [MainThread]: Command end result
[0m11:38:19.435114 [info ] [MainThread]: 
[0m11:38:19.436117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:19.437120 [info ] [MainThread]: 
[0m11:38:19.438114 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:19.439402 [debug] [MainThread]: Command `dbt seed` succeeded at 11:38:19.439402 after 13.32 seconds
[0m11:38:19.440515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BF082F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BF27B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BF27BF0>]}
[0m11:38:19.441030 [debug] [MainThread]: Flushing usage events
[0m11:46:50.825660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099E52B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209A07B5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209A1142480>]}


============================== 11:46:50.825660 | 686897f0-45d1-4c55-923c-6f4df26957bc ==============================
[0m11:46:50.825660 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:46:50.825660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:52.122955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209A11BC9B0>]}
[0m11:46:52.186162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B4569AC0>]}
[0m11:46:52.186162 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:46:52.186162 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:46:52.240979 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:52.240979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B48DB620>]}
[0m11:46:53.220714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B4937890>]}
[0m11:46:53.299180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B4C02F60>]}
[0m11:46:53.299180 [info ] [MainThread]: Found 1 model, 1 seed, 478 macros
[0m11:46:53.299180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B4C0CDA0>]}
[0m11:46:53.299180 [info ] [MainThread]: 
[0m11:46:53.299180 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:46:53.299180 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212'
[0m11:46:53.299180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:54.710035 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-437212_wellbefore'
[0m11:46:54.710035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:55.932277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B46E8D70>]}
[0m11:46:55.932277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:55.932277 [info ] [MainThread]: 
[0m11:46:55.947754 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m11:46:55.949869 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_orders .............................. [RUN]
[0m11:46:55.951363 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_orders'
[0m11:46:55.951363 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m11:46:55.958401 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m11:46:55.958401 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m11:46:55.991061 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m11:46:55.991061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:46:56.024581 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbt-437212`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m11:46:57.407477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:8bd4806c-b9ec-4ba7-80b3-d7c97b6b7700&page=queryresults
[0m11:46:58.284640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '686897f0-45d1-4c55-923c-6f4df26957bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B3C582F0>]}
[0m11:46:58.284640 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m11:46:58.284640 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m11:46:58.284640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:58.284640 [debug] [MainThread]: Connection 'list_dbt-437212' was properly closed.
[0m11:46:58.284640 [debug] [MainThread]: Connection 'list_dbt-437212_wellbefore' was properly closed.
[0m11:46:58.284640 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m11:46:58.284640 [info ] [MainThread]: 
[0m11:46:58.284640 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m11:46:58.284640 [debug] [MainThread]: Command end result
[0m11:46:58.328095 [info ] [MainThread]: 
[0m11:46:58.329168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:58.329168 [info ] [MainThread]: 
[0m11:46:58.329168 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:46:58.329168 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:58.329168 after 7.68 seconds
[0m11:46:58.329168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B4A19490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B3C69F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209A08537D0>]}
[0m11:46:58.329168 [debug] [MainThread]: Flushing usage events
[0m18:02:22.921844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D4ABB86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D4D3BDBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D4D6827B0>]}


============================== 18:02:22.921844 | d9538931-9bbd-4bcd-a19c-da4e74ff5af6 ==============================
[0m18:02:22.921844 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:02:22.921844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:02:22.953389 [info ] [MainThread]: dbt version: 1.8.6
[0m18:02:22.953389 [info ] [MainThread]: python version: 3.12.6
[0m18:02:22.960924 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m18:02:22.960924 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:02:30.748202 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m18:02:30.749493 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m18:02:30.749493 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp\dbt_project.yml
[0m18:02:30.749493 [info ] [MainThread]: adapter type: bigquery
[0m18:02:30.749493 [info ] [MainThread]: adapter version: 1.8.2
[0m18:02:30.866573 [info ] [MainThread]: Configuration:
[0m18:02:30.866573 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:02:30.866573 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:02:30.870406 [info ] [MainThread]: Required dependencies:
[0m18:02:30.870406 [debug] [MainThread]: Executing "git --help"
[0m18:02:30.930100 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:02:30.930100 [debug] [MainThread]: STDERR: "b''"
[0m18:02:30.930100 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:02:30.930100 [info ] [MainThread]: Connection:
[0m18:02:30.935620 [info ] [MainThread]:   method: service-account
[0m18:02:30.935620 [info ] [MainThread]:   database: dbtproject-439612
[0m18:02:30.937270 [info ] [MainThread]:   execution_project: dbtproject-439612
[0m18:02:30.937270 [info ] [MainThread]:   schema: wellbefore
[0m18:02:30.937270 [info ] [MainThread]:   location: US
[0m18:02:30.937270 [info ] [MainThread]:   priority: interactive
[0m18:02:30.937270 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:02:30.937270 [info ] [MainThread]:   impersonate_service_account: None
[0m18:02:30.937270 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:02:30.937270 [info ] [MainThread]:   job_retries: 1
[0m18:02:30.937270 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:02:30.943777 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:02:30.943777 [info ] [MainThread]:   timeout_seconds: 300
[0m18:02:30.943777 [info ] [MainThread]:   client_id: None
[0m18:02:30.945513 [info ] [MainThread]:   token_uri: None
[0m18:02:30.945513 [info ] [MainThread]:   dataproc_region: None
[0m18:02:30.945513 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:02:30.945513 [info ] [MainThread]:   gcs_bucket: None
[0m18:02:30.945513 [info ] [MainThread]:   dataproc_batch: None
[0m18:02:30.945513 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:02:30.945513 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:02:30.945513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:30.992068 [debug] [MainThread]: On debug: select 1 as id
[0m18:02:33.543490 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8047ad64-5154-49ec-9d79-319998b775e4&page=queryresults
[0m18:02:34.560650 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:02:34.560650 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:02:34.560650 [debug] [MainThread]: Command `dbt debug` succeeded at 18:02:34.560650 after 11.90 seconds
[0m18:02:34.560650 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:02:34.560650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D4D3F02C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60C0D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D4D5B22D0>]}
[0m18:02:34.560650 [debug] [MainThread]: Flushing usage events
[0m18:02:47.531197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB50102C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB711E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB711DD00>]}


============================== 18:02:47.531197 | a9d23159-2c55-4815-8505-c13fa94570ed ==============================
[0m18:02:47.531197 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:02:47.531197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:02:49.183232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECAF84F50>]}
[0m18:02:49.263440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECA61DD00>]}
[0m18:02:49.263440 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:02:49.292221 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:02:49.439071 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:02:49.439071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECB2733B0>]}
[0m18:02:51.458589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECB4109E0>]}
[0m18:02:51.560001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECB581940>]}
[0m18:02:51.560001 [info ] [MainThread]: Found 1 model, 1 seed, 478 macros
[0m18:02:51.575637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECB5962D0>]}
[0m18:02:51.575637 [info ] [MainThread]: 
[0m18:02:51.575637 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:02:51.575637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:02:51.575637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:52.915393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtproject-439612, now create_dbtproject-439612_wellbefore)
[0m18:02:52.915393 [debug] [ThreadPool]: Creating schema "database: "dbtproject-439612"
schema: "wellbefore"
"
[0m18:02:52.915393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:52.970977 [debug] [ThreadPool]: On create_dbtproject-439612_wellbefore: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "connection_name": "create_dbtproject-439612_wellbefore"} */
create schema if not exists `dbtproject-439612`.`wellbefore`
  
[0m18:02:54.639695 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2409d000-e241-412d-a1b6-26764250dc13&page=queryresults
[0m18:02:57.106656 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:02:57.106656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:58.488634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ECB43F1A0>]}
[0m18:02:58.488634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:58.488634 [info ] [MainThread]: 
[0m18:02:58.494220 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:02:58.494850 [info ] [Thread-1 (]: 1 of 1 START seed file wellbefore.BuyBox_raw_ds_first20_entries ................ [RUN]
[0m18:02:58.494850 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.buy_box_gcp.BuyBox_raw_ds_first20_entries'
[0m18:02:58.497359 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:02:58.498078 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:02:58.526723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:03:06.048983 [debug] [Thread-1 (]: On seed.buy_box_gcp.BuyBox_raw_ds_first20_entries: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "seed.buy_box_gcp.BuyBox_raw_ds_first20_entries"} */

    alter table `dbtproject-439612`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()
  
[0m18:03:06.630317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:f156646b-e8ba-405b-9d04-c0f0fea40870&page=queryresults
[0m18:03:07.601119 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp.BuyBox_raw_ds_first20_entries"
[0m18:03:07.616753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d23159-2c55-4815-8505-c13fa94570ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB5539460>]}
[0m18:03:07.616753 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries ............ [[32mINSERT 20[0m in 9.12s]
[0m18:03:07.616753 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:03:07.616753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:07.616753 [debug] [MainThread]: Connection 'create_dbtproject-439612_wellbefore' was properly closed.
[0m18:03:07.616753 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:03:07.616753 [debug] [MainThread]: Connection 'seed.buy_box_gcp.BuyBox_raw_ds_first20_entries' was properly closed.
[0m18:03:07.616753 [info ] [MainThread]: 
[0m18:03:07.616753 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 16.04 seconds (16.04s).
[0m18:03:07.616753 [debug] [MainThread]: Command end result
[0m18:03:07.659195 [info ] [MainThread]: 
[0m18:03:07.659195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:07.672206 [info ] [MainThread]: 
[0m18:03:07.672206 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:03:07.672206 [debug] [MainThread]: Command `dbt seed` succeeded at 18:03:07.672206 after 20.27 seconds
[0m18:03:07.676311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB7798680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB7AFF6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB794D8E0>]}
[0m18:03:07.677076 [debug] [MainThread]: Flushing usage events
[0m18:03:41.198798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD75B9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD75B9F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD75B88C0>]}


============================== 18:03:41.198798 | 9004f0c2-ddad-491c-8f0c-455fea1a1570 ==============================
[0m18:03:41.198798 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:03:41.198798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:42.829149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CEAAC64B0>]}
[0m18:03:42.904264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD6740A40>]}
[0m18:03:42.904264 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:03:42.904264 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:03:43.077357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:43.077357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:43.121128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CEAD51130>]}
[0m18:03:43.216980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CEAE0A000>]}
[0m18:03:43.216980 [info ] [MainThread]: Found 1 model, 1 seed, 478 macros
[0m18:03:43.216980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD7642480>]}
[0m18:03:43.222858 [info ] [MainThread]: 
[0m18:03:43.224585 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:43.226695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:03:43.227204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:44.503569 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:03:44.503569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:46.119637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CEACC9550>]}
[0m18:03:46.119637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:46.119637 [info ] [MainThread]: 
[0m18:03:46.119637 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:03:46.119637 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:03:46.119637 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_orders'
[0m18:03:46.119637 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:03:46.133198 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:03:46.138989 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:03:46.173226 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:03:46.183750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:03:46.233140 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:03:47.703070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:f6a8e955-d167-453e-ab12-5668b8d7b908&page=queryresults
[0m18:03:47.703070 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:f6a8e955-d167-453e-ab12-5668b8d7b908&page=queryresults
[0m18:03:47.774721 [debug] [Thread-1 (]: Database Error in model src_orders (models\src\src_orders.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_orders.sql
[0m18:03:47.782780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9004f0c2-ddad-491c-8f0c-455fea1a1570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD6E23800>]}
[0m18:03:47.782780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_orders ..................... [[31mERROR[0m in 1.66s]
[0m18:03:47.782780 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:03:47.782780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:47.789114 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:03:47.789114 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:03:47.789114 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:03:47.789114 [info ] [MainThread]: 
[0m18:03:47.789114 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m18:03:47.792067 [debug] [MainThread]: Command end result
[0m18:03:47.823611 [info ] [MainThread]: 
[0m18:03:47.823611 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:47.823611 [info ] [MainThread]: 
[0m18:03:47.823611 [error] [MainThread]:   Database Error in model src_orders (models\src\src_orders.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_orders.sql
[0m18:03:47.823611 [info ] [MainThread]: 
[0m18:03:47.823611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:03:47.823611 [debug] [MainThread]: Command `dbt run` failed at 18:03:47.823611 after 6.80 seconds
[0m18:03:47.823611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CEACC8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD73F1A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD75E9610>]}
[0m18:03:47.823611 [debug] [MainThread]: Flushing usage events
[0m18:04:16.305882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B45C3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B45C12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B45C3B60>]}


============================== 18:04:16.305882 | 08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949 ==============================
[0m18:04:16.305882 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:04:16.305882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:17.945140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B2022810>]}
[0m18:04:18.013828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B419B9B0>]}
[0m18:04:18.014489 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:04:18.028750 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:04:18.159888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:18.160396 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_orders.sql
[0m18:04:18.427467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B3617440>]}
[0m18:04:18.506080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120C7F85430>]}
[0m18:04:18.506080 [info ] [MainThread]: Found 1 seed, 1 model, 478 macros
[0m18:04:18.506080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120C7D61670>]}
[0m18:04:18.506080 [info ] [MainThread]: 
[0m18:04:18.506080 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:04:18.522018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:04:18.522524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:19.876986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:04:19.892717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:21.460273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120C7FA0EF0>]}
[0m18:04:21.460273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:21.473878 [info ] [MainThread]: 
[0m18:04:21.476492 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:04:21.476492 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:04:21.476492 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_orders'
[0m18:04:21.480227 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:04:21.489657 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:04:21.492226 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:04:21.525683 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:04:21.525683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:21.578539 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:04:23.205273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:6f52e07e-acb2-42ad-8788-1db6e66808a1&page=queryresults
[0m18:04:24.062278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d2a7fa-40d9-4d4c-a0a6-b93bc7f99949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120C70D84A0>]}
[0m18:04:24.062278 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m18:04:24.062278 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:04:24.076493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:24.078146 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:04:24.078652 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:04:24.078652 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:04:24.078652 [info ] [MainThread]: 
[0m18:04:24.078652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m18:04:24.081131 [debug] [MainThread]: Command end result
[0m18:04:24.124649 [info ] [MainThread]: 
[0m18:04:24.124649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:24.124649 [info ] [MainThread]: 
[0m18:04:24.136662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:04:24.136662 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:24.136662 after 7.98 seconds
[0m18:04:24.136662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120C7176D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120C7B35F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120B35A8800>]}
[0m18:04:24.139760 [debug] [MainThread]: Flushing usage events
[0m18:13:33.292158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001620D2D3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001620D2D35C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001620D2D3530>]}


============================== 18:13:33.292158 | 3a069839-216f-4a61-b560-41165e3cc49c ==============================
[0m18:13:33.292158 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:13:33.292158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:36.611385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016220787CE0>]}
[0m18:13:36.748475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162201058E0>]}
[0m18:13:36.751506 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:13:36.774698 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:13:36.982941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:13:36.982941 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_notifications.sql
[0m18:13:37.315328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016220CDB710>]}
[0m18:13:37.435711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016220953F50>]}
[0m18:13:37.435711 [info ] [MainThread]: Found 1 seed, 2 models, 478 macros
[0m18:13:37.435711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162208AF6E0>]}
[0m18:13:37.435711 [info ] [MainThread]: 
[0m18:13:37.435711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:13:37.449360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:13:37.449360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:39.808630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:13:39.808630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:42.178357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016220CDFE00>]}
[0m18:13:42.185491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:42.185491 [info ] [MainThread]: 
[0m18:13:42.189163 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:13:42.189163 [info ] [Thread-1 (]: 1 of 2 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:13:42.189163 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notifications'
[0m18:13:42.202167 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:13:42.219396 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:13:42.237736 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:13:42.345206 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:13:42.353488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:42.475493 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
        raw_data:"Payload"::OBJECT:"AnyOfferChangedNotification"::OBJECT:"OfferChangeTrigger"::ARRAY AS offer
    FROM 
        BUY_BOX.DEV.BUYBOX_RAW_DS_FIRST20_ENTRIES
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS NotificationId,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:13:45.293779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ec765b10-000e-4426-99f5-d8f28333df2b&page=queryresults
[0m18:13:45.293779 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "raw_data" at [10:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "raw_data" at [10:9]')
[0m18:13:46.429360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0b2cf675-bff0-4cd9-9eb1-f7adacc5904e&page=queryresults
[0m18:13:46.430423 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0b2cf675-bff0-4cd9-9eb1-f7adacc5904e&page=queryresults
[0m18:13:46.441165 [debug] [Thread-1 (]: Database Error in model src_notifications (models\src\src_notifications.sql)
  Syntax error: Expected ")" but got identifier "raw_data" at [10:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:13:46.442250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001620C9E3710>]}
[0m18:13:46.446268 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model wellbefore.src_notifications .............. [[31mERROR[0m in 4.25s]
[0m18:13:46.450870 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:13:46.451950 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:13:46.458238 [info ] [Thread-1 (]: 2 of 2 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:13:46.459203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:13:46.459203 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:13:46.466908 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:13:46.470444 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:13:46.481049 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:13:46.485723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:46.610299 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:13:48.999144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:663eda91-b63d-48c0-9f3e-3ac125ad97f9&page=queryresults
[0m18:13:49.926909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a069839-216f-4a61-b560-41165e3cc49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001621FDE8AD0>]}
[0m18:13:49.926909 [info ] [Thread-1 (]: 2 of 2 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 3.47s]
[0m18:13:49.926909 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:13:49.934998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:49.934998 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:13:49.938667 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:13:49.939621 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:13:49.941042 [info ] [MainThread]: 
[0m18:13:49.942568 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m18:13:49.943457 [debug] [MainThread]: Command end result
[0m18:13:50.022222 [info ] [MainThread]: 
[0m18:13:50.022222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:13:50.022222 [info ] [MainThread]: 
[0m18:13:50.022222 [error] [MainThread]:   Database Error in model src_notifications (models\src\src_notifications.sql)
  Syntax error: Expected ")" but got identifier "raw_data" at [10:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:13:50.022222 [info ] [MainThread]: 
[0m18:13:50.034737 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:13:50.035751 [debug] [MainThread]: Command `dbt run` failed at 18:13:50.035751 after 16.96 seconds
[0m18:13:50.035751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162209269C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162206F8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001620CEC8D70>]}
[0m18:13:50.043934 [debug] [MainThread]: Flushing usage events
[0m18:14:42.333311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F562DC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F562DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F562C620>]}


============================== 18:14:42.333311 | 7d28803e-6a13-4b70-85b2-67a6197280e9 ==============================
[0m18:14:42.333311 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:14:42.333311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:14:43.954125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F31EA510>]}
[0m18:14:44.017255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2885D3D70>]}
[0m18:14:44.017255 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:14:44.038134 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:14:44.184814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:44.184814 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notifications.sql
[0m18:14:44.450645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28926B8C0>]}
[0m18:14:44.546184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288EE3350>]}
[0m18:14:44.546184 [info ] [MainThread]: Found 1 seed, 2 models, 478 macros
[0m18:14:44.546184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28926B560>]}
[0m18:14:44.562520 [info ] [MainThread]: 
[0m18:14:44.562520 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:44.562520 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:14:44.562520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:45.852766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:14:45.852766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:47.245984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288EA2510>]}
[0m18:14:47.245984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:47.245984 [info ] [MainThread]: 
[0m18:14:47.261376 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:14:47.261376 [info ] [Thread-1 (]: 1 of 2 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:14:47.263488 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notifications'
[0m18:14:47.263488 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:14:47.275952 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:14:47.275952 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:14:47.337316 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:14:47.337316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:47.376160 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        BUY_BOX.DEV.BUYBOX_RAW_DS_FIRST20_ENTRIES
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS NotificationId,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:14:48.692853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:37997007-3c66-491c-9044-1f3d363f8b56&page=queryresults
[0m18:14:48.692853 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "JSON_VALUE" at [16:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "JSON_VALUE" at [16:9]')
[0m18:14:49.296210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:13673397-59b6-435e-b121-2846eff1623c&page=queryresults
[0m18:14:49.296210 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:13673397-59b6-435e-b121-2846eff1623c&page=queryresults
[0m18:14:49.296210 [debug] [Thread-1 (]: Database Error in model src_notifications (models\src\src_notifications.sql)
  Syntax error: Expected ")" but got identifier "JSON_VALUE" at [16:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:14:49.312435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28A5F2E10>]}
[0m18:14:49.313354 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model wellbefore.src_notifications .............. [[31mERROR[0m in 2.03s]
[0m18:14:49.314113 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:14:49.315289 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:14:49.317112 [info ] [Thread-1 (]: 2 of 2 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:14:49.318215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:14:49.318215 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:14:49.320101 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:14:49.323345 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:14:49.325033 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:14:49.325033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:49.356077 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:14:50.743586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:de7c2304-7824-46f0-96d1-83217354d7e8&page=queryresults
[0m18:14:51.607241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d28803e-6a13-4b70-85b2-67a6197280e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288378830>]}
[0m18:14:51.607241 [info ] [Thread-1 (]: 2 of 2 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.29s]
[0m18:14:51.607241 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:14:51.623617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:51.623617 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:14:51.623617 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:14:51.623617 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:14:51.623617 [info ] [MainThread]: 
[0m18:14:51.623617 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m18:14:51.628653 [debug] [MainThread]: Command end result
[0m18:14:51.656448 [info ] [MainThread]: 
[0m18:14:51.656448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:14:51.656448 [info ] [MainThread]: 
[0m18:14:51.656448 [error] [MainThread]:   Database Error in model src_notifications (models\src\src_notifications.sql)
  Syntax error: Expected ")" but got identifier "JSON_VALUE" at [16:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:14:51.656448 [info ] [MainThread]: 
[0m18:14:51.669126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:14:51.670323 [debug] [MainThread]: Command `dbt run` failed at 18:14:51.670323 after 9.52 seconds
[0m18:14:51.672501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288D88470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F57ACF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F57AFD70>]}
[0m18:14:51.672501 [debug] [MainThread]: Flushing usage events
[0m18:15:08.611350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566A2E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566A2E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566A2CAA0>]}


============================== 18:15:08.627041 | c4357715-60e1-4eb8-b1a0-bff28b6bb142 ==============================
[0m18:15:08.627041 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:15:08.627190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:15:10.053943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215645EA720>]}
[0m18:15:10.115750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566BC4DA0>]}
[0m18:15:10.115750 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:15:10.115750 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:15:10.253016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:10.253016 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notifications.sql
[0m18:15:10.474479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157A5CB9B0>]}
[0m18:15:10.553184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157A26C3E0>]}
[0m18:15:10.553184 [info ] [MainThread]: Found 1 seed, 2 models, 478 macros
[0m18:15:10.553184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157A5C9460>]}
[0m18:15:10.553184 [info ] [MainThread]: 
[0m18:15:10.568821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:15:10.568821 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:15:10.568821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:11.830370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:15:11.830370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:13.155641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021579AA9220>]}
[0m18:15:13.155641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:13.155641 [info ] [MainThread]: 
[0m18:15:13.171349 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:15:13.174592 [info ] [Thread-1 (]: 1 of 2 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:15:13.176027 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notifications'
[0m18:15:13.176754 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:15:13.189163 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:15:13.192553 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:15:13.222060 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:15:13.222060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:15:13.267158 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        BUY_BOX.DEV.BUYBOX_RAW_DS_FIRST20_ENTRIES
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS NotificationId,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:15:14.781669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:57012bc9-3c4f-48d3-bbde-fe6289cbc4d0&page=queryresults
[0m18:15:14.781669 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'BUY_BOX'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: BUY_BOX.DEV.BUYBOX_RAW_DS_FIRST20_ENTRIES, message: Invalid project ID 'BUY_BOX'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m18:15:15.312571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8e688a56-570b-4b26-9325-3d8dddc426a6&page=queryresults
[0m18:15:15.312571 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8e688a56-570b-4b26-9325-3d8dddc426a6&page=queryresults
[0m18:15:15.312571 [debug] [Thread-1 (]: Database Error in model src_notifications (models\src\src_notifications.sql)
  Invalid project ID 'BUY_BOX'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:15:15.312571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021565BDF590>]}
[0m18:15:15.326589 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model wellbefore.src_notifications .............. [[31mERROR[0m in 2.14s]
[0m18:15:15.326589 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:15:15.328256 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:15:15.329242 [info ] [Thread-1 (]: 2 of 2 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:15:15.329242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:15:15.329242 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:15:15.329242 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:15:15.329242 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:15:15.339403 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:15:15.339403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:15.373555 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:15:16.822974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3f22f0a0-4d48-4c9e-9631-697cb705905b&page=queryresults
[0m18:15:17.790060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4357715-60e1-4eb8-b1a0-bff28b6bb142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215796D86E0>]}
[0m18:15:17.797064 [info ] [Thread-1 (]: 2 of 2 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m18:15:17.797064 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:15:17.797064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:17.797064 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:15:17.797064 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:15:17.797064 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:15:17.797064 [info ] [MainThread]: 
[0m18:15:17.797064 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m18:15:17.797064 [debug] [MainThread]: Command end result
[0m18:15:17.840137 [info ] [MainThread]: 
[0m18:15:17.840137 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:15:17.840137 [info ] [MainThread]: 
[0m18:15:17.840137 [error] [MainThread]:   Database Error in model src_notifications (models\src\src_notifications.sql)
  Invalid project ID 'BUY_BOX'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:15:17.852782 [info ] [MainThread]: 
[0m18:15:17.854234 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:15:17.856271 [debug] [MainThread]: Command `dbt run` failed at 18:15:17.856271 after 9.35 seconds
[0m18:15:17.856271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215662568A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566BA9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566BA8BF0>]}
[0m18:15:17.856271 [debug] [MainThread]: Flushing usage events
[0m18:16:31.442492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7EC28530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7F949EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D016F6C60>]}


============================== 18:16:31.450809 | b645baa7-de47-48bf-9b19-d18537943a71 ==============================
[0m18:16:31.450809 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:16:31.452094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:16:32.973264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D01769700>]}
[0m18:16:33.038501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7F620EF0>]}
[0m18:16:33.038501 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:16:33.043008 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:16:33.205795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:33.205795 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notifications.sql
[0m18:16:33.448871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D1513BA70>]}
[0m18:16:33.539978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D1513B770>]}
[0m18:16:33.539978 [info ] [MainThread]: Found 1 seed, 2 models, 478 macros
[0m18:16:33.539978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D14DB3AA0>]}
[0m18:16:33.539978 [info ] [MainThread]: 
[0m18:16:33.539978 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:16:33.555804 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:16:33.555804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:34.842329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:16:34.842329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:36.391246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D15137DA0>]}
[0m18:16:36.391246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:36.391246 [info ] [MainThread]: 
[0m18:16:36.397547 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:16:36.398589 [info ] [Thread-1 (]: 1 of 2 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:16:36.399321 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notifications'
[0m18:16:36.400487 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:16:36.409350 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:16:36.409350 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:16:36.444598 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:16:36.444598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:16:36.500360 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS NotificationId,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:16:38.256102 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:4da1b9f3-9d2c-498c-a9a7-57e0253937b6&page=queryresults
[0m18:16:38.978554 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name NotificationId at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name NotificationId at [6:6]')
[0m18:16:40.102402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:601d323b-ec55-44c7-a5bb-970d6220d11e&page=queryresults
[0m18:16:40.549131 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:601d323b-ec55-44c7-a5bb-970d6220d11e&page=queryresults
[0m18:16:40.563077 [debug] [Thread-1 (]: Database Error in model src_notifications (models\src\src_notifications.sql)
  CREATE VIEW has columns with duplicate name NotificationId at [6:6]
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:16:40.563077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D164C3230>]}
[0m18:16:40.563077 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model wellbefore.src_notifications .............. [[31mERROR[0m in 4.16s]
[0m18:16:40.578776 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:16:40.579840 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:16:40.580996 [info ] [Thread-1 (]: 2 of 2 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:16:40.580996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:16:40.580996 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:16:40.580996 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:16:40.590474 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:16:40.593815 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:16:40.593815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:40.644650 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:16:42.339475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2f99bb0e-a3bd-4d9d-8caf-4393d1e6c0bd&page=queryresults
[0m18:16:43.291230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b645baa7-de47-48bf-9b19-d18537943a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D165CBE30>]}
[0m18:16:43.302062 [info ] [Thread-1 (]: 2 of 2 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.71s]
[0m18:16:43.303640 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:16:43.303640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:43.303640 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:16:43.303640 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:16:43.303640 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:16:43.303640 [info ] [MainThread]: 
[0m18:16:43.306971 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m18:16:43.308205 [debug] [MainThread]: Command end result
[0m18:16:43.351767 [info ] [MainThread]: 
[0m18:16:43.351767 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:16:43.353896 [info ] [MainThread]: 
[0m18:16:43.353896 [error] [MainThread]:   Database Error in model src_notifications (models\src\src_notifications.sql)
  CREATE VIEW has columns with duplicate name NotificationId at [6:6]
  compiled Code at target\run\buy_box_gcp\models\src\src_notifications.sql
[0m18:16:43.353896 [info ] [MainThread]: 
[0m18:16:43.358894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:16:43.358894 [debug] [MainThread]: Command `dbt run` failed at 18:16:43.358894 after 12.14 seconds
[0m18:16:43.358894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D15072DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D01768560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0171CE90>]}
[0m18:16:43.358894 [debug] [MainThread]: Flushing usage events
[0m18:17:30.459798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E8F13860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E8F13AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E8F139E0>]}


============================== 18:17:30.459798 | 2cad22ab-b739-4dde-8c37-9993efe64874 ==============================
[0m18:17:30.459798 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:17:30.459798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:17:31.777267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E8F896D0>]}
[0m18:17:31.840669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E8F541D0>]}
[0m18:17:31.840669 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:17:31.848671 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:17:31.982393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:31.982393 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notifications.sql
[0m18:17:32.229438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC91BA10>]}
[0m18:17:32.295049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC5B7EC0>]}
[0m18:17:32.295049 [info ] [MainThread]: Found 1 seed, 2 models, 478 macros
[0m18:17:32.311605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC77E540>]}
[0m18:17:32.311605 [info ] [MainThread]: 
[0m18:17:32.315416 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:17:32.320268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:17:32.321451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:33.562664 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:17:33.563444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:34.876668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC77E540>]}
[0m18:17:34.876668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:34.876668 [info ] [MainThread]: 
[0m18:17:34.892152 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:17:34.892152 [info ] [Thread-1 (]: 1 of 2 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:17:34.892152 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notifications'
[0m18:17:34.892152 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:17:34.892152 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:17:34.892152 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:17:34.925630 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:17:34.932501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:34.958491 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:17:36.939586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8711459a-2557-47cc-b29b-889721f3c412&page=queryresults
[0m18:17:37.780511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FBA28140>]}
[0m18:17:37.780511 [info ] [Thread-1 (]: 1 of 2 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 2.89s]
[0m18:17:37.780511 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:17:37.780511 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:17:37.780511 [info ] [Thread-1 (]: 2 of 2 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:17:37.780511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:17:37.796134 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:17:37.796134 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:17:37.796134 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:17:37.796134 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:17:37.796134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:37.845019 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:17:39.290108 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:17559b10-b4ac-4148-a721-a9214036664e&page=queryresults
[0m18:17:40.212180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cad22ab-b739-4dde-8c37-9993efe64874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FDD465D0>]}
[0m18:17:40.212180 [info ] [Thread-1 (]: 2 of 2 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m18:17:40.212180 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:17:40.224225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:40.224225 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:17:40.224225 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:17:40.224225 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:17:40.226565 [info ] [MainThread]: 
[0m18:17:40.226565 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m18:17:40.229220 [debug] [MainThread]: Command end result
[0m18:17:40.277113 [info ] [MainThread]: 
[0m18:17:40.277113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:40.277113 [info ] [MainThread]: 
[0m18:17:40.277113 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:17:40.277113 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:40.277113 after 9.94 seconds
[0m18:17:40.277113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC592600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC9193A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294FC7AA180>]}
[0m18:17:40.277113 [debug] [MainThread]: Flushing usage events
[0m18:28:38.195959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965BFE8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965E92D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965E92D0A0>]}


============================== 18:28:38.209765 | 77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d ==============================
[0m18:28:38.209765 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:28:38.209765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:39.586407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196717948F0>]}
[0m18:28:39.633778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965E6AA870>]}
[0m18:28:39.633778 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:28:39.649413 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:28:39.761569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:28:39.761569 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:28:40.010709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196724C3EC0>]}
[0m18:28:40.084499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196721AA810>]}
[0m18:28:40.084499 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:28:40.096513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196724955E0>]}
[0m18:28:40.096513 [info ] [MainThread]: 
[0m18:28:40.100521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:28:40.101169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:28:40.101169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:41.782421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:28:41.782421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:43.580098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967231D2E0>]}
[0m18:28:43.580098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:43.580098 [info ] [MainThread]: 
[0m18:28:43.590560 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:28:43.590560 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:28:43.590560 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:28:43.590560 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:28:43.601336 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:28:43.602051 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:28:43.645944 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:28:43.645944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:43.692246 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
    JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
)
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
FROM flatten_data
)

SELECT * FROM flatten_data_1;


[0m18:28:44.981216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ad86f25e-e64b-47b7-8148-f61b9f0be3c4&page=queryresults
[0m18:28:44.981216 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]')
[0m18:28:45.971888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d79c62c9-32f5-466a-9374-11a6c264703c&page=queryresults
[0m18:28:45.971888 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d79c62c9-32f5-466a-9374-11a6c264703c&page=queryresults
[0m18:28:45.971888 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:28:45.971888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967253BBC0>]}
[0m18:28:45.971888 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 2.38s]
[0m18:28:45.987530 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:28:45.988458 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:28:45.988711 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:28:45.988711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:28:45.988711 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:28:45.988711 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:28:45.988711 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:28:45.997877 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:28:46.000220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:46.039864 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:28:47.542805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:411be0f0-23bb-4510-91d7-cedff8a90cc9&page=queryresults
[0m18:28:48.412724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196715C88C0>]}
[0m18:28:48.412724 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m18:28:48.412724 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:28:48.412724 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:28:48.412724 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:28:48.412724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:28:48.412724 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:28:48.412724 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:28:48.412724 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:28:48.431315 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:28:48.433567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:48.475217 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:28:50.182070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d0f5ccb8-73c3-47fb-983a-beff192ff128&page=queryresults
[0m18:28:51.161124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77aac3fd-6bbb-4087-a53b-f7ab7af7fc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019672527EC0>]}
[0m18:28:51.161124 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m18:28:51.161124 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:28:51.161124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:51.161124 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:28:51.161124 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:28:51.161124 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:28:51.161124 [info ] [MainThread]: 
[0m18:28:51.161124 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 11.06 seconds (11.06s).
[0m18:28:51.173447 [debug] [MainThread]: Command end result
[0m18:28:51.256049 [info ] [MainThread]: 
[0m18:28:51.257602 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:28:51.257602 [info ] [MainThread]: 
[0m18:28:51.257602 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:28:51.257602 [info ] [MainThread]: 
[0m18:28:51.265527 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:28:51.269180 [debug] [MainThread]: Command `dbt run` failed at 18:28:51.269180 after 13.26 seconds
[0m18:28:51.269180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965E72AE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967231F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965E751220>]}
[0m18:28:51.272629 [debug] [MainThread]: Flushing usage events
[0m18:30:09.533883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76CAA88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76CAA8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76CAAB500>]}


============================== 18:30:09.533883 | df47a034-72db-404e-8340-f2e97e7560e8 ==============================
[0m18:30:09.533883 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:30:09.533883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:10.825750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A700246B70>]}
[0m18:30:10.878325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A77F675370>]}
[0m18:30:10.878325 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:30:10.893944 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:30:11.008390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:11.008390 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:30:11.223934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76BAD8440>]}
[0m18:30:11.291074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A700389DC0>]}
[0m18:30:11.291074 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:30:11.291074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7004CBEC0>]}
[0m18:30:11.291074 [info ] [MainThread]: 
[0m18:30:11.291074 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:11.301666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:30:11.301666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:12.541038 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:30:12.541038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:13.812952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7002D0DD0>]}
[0m18:30:13.812952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:13.812952 [info ] [MainThread]: 
[0m18:30:13.826675 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:30:13.826675 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:30:13.828513 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:30:13.829428 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:30:13.829532 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:30:13.829532 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:30:13.859573 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:30:13.859573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:30:13.892398 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
    JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
)
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:30:15.254918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5c7b7137-aede-42f9-be67-b7be05811ab5&page=queryresults
[0m18:30:15.254918 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]')
[0m18:30:15.884232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:54c3ec12-6767-476e-9e1d-4599b031a9e5&page=queryresults
[0m18:30:15.887531 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:54c3ec12-6767-476e-9e1d-4599b031a9e5&page=queryresults
[0m18:30:15.896757 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:30:15.900171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A70065C470>]}
[0m18:30:15.901907 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 2.07s]
[0m18:30:15.902768 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:30:15.902768 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:30:15.902768 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:30:15.906705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:30:15.906705 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:30:15.911015 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:30:15.913699 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:30:15.913699 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:30:15.913699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:15.959524 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:30:17.403590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:87cef6e9-1260-418d-a6b3-bb0a72b5d8b3&page=queryresults
[0m18:30:18.294347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A701B29E80>]}
[0m18:30:18.294347 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 2.39s]
[0m18:30:18.294347 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:30:18.294347 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:30:18.294347 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:30:18.294347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:30:18.294347 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:30:18.294347 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:30:18.294347 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:30:18.294347 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:30:18.311484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:18.342838 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:30:20.148320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:eeebdfe5-cf43-4c08-bea2-ec1f05f23e08&page=queryresults
[0m18:30:21.045561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df47a034-72db-404e-8340-f2e97e7560e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7016DFD70>]}
[0m18:30:21.045561 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m18:30:21.045561 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:30:21.045561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:21.045561 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:30:21.045561 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:30:21.045561 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:30:21.045561 [info ] [MainThread]: 
[0m18:30:21.045561 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m18:30:21.061291 [debug] [MainThread]: Command end result
[0m18:30:21.076058 [info ] [MainThread]: 
[0m18:30:21.076058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:21.076058 [info ] [MainThread]: 
[0m18:30:21.076058 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:30:21.076058 [info ] [MainThread]: 
[0m18:30:21.076058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:30:21.093088 [debug] [MainThread]: Command `dbt run` failed at 18:30:21.093088 after 11.68 seconds
[0m18:30:21.093088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76C705D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76BC27050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76CA4FFB0>]}
[0m18:30:21.093088 [debug] [MainThread]: Flushing usage events
[0m18:34:08.410681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E805E51D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808968E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8088E3BF0>]}


============================== 18:34:08.414685 | f9bea529-8927-4c23-b716-28b281aa4cec ==============================
[0m18:34:08.414685 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:34:08.414685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:34:09.669406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E807A1DE50>]}
[0m18:34:09.737696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81BFE1700>]}
[0m18:34:09.738605 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:34:09.745256 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:34:09.861965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:09.862878 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:34:10.098964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80868A7E0>]}
[0m18:34:10.163802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81C18ADE0>]}
[0m18:34:10.163802 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:34:10.177816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80668F290>]}
[0m18:34:10.177816 [info ] [MainThread]: 
[0m18:34:10.177816 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:34:10.177816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:34:10.177816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:11.863616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:34:11.863616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:13.402506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81C046600>]}
[0m18:34:13.402506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:13.402506 [info ] [MainThread]: 
[0m18:34:13.402506 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:34:13.402506 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:34:13.419391 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:34:13.420046 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:34:13.429674 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:34:13.431063 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:34:13.466992 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:34:13.466992 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:13.515419 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    PARSE_JSON(offer.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
    PARSE_JSON(offer.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
)
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:34:14.725020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:112c4079-4d19-4a8b-b008-b8d9ed157307&page=queryresults
[0m18:34:14.725020 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "PARSE_JSON" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "PARSE_JSON" at [14:5]')
[0m18:34:15.267837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:fd27976c-6a45-4204-9afa-8e3fe567ab2a&page=queryresults
[0m18:34:15.267837 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:fd27976c-6a45-4204-9afa-8e3fe567ab2a&page=queryresults
[0m18:34:15.283390 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "PARSE_JSON" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:34:15.283390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81C516F60>]}
[0m18:34:15.283390 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 1.87s]
[0m18:34:15.283390 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:34:15.283390 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:34:15.295429 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:34:15.297209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:34:15.297209 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:34:15.297209 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:34:15.297209 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:34:15.297209 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:34:15.297209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:15.332998 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:34:16.760751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:60f3bcd9-b588-4194-9c6a-8014d4a250c9&page=queryresults
[0m18:34:17.633754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81D958380>]}
[0m18:34:17.633754 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m18:34:17.633754 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:34:17.633754 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:34:17.633754 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:34:17.633754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:34:17.633754 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:34:17.649379 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:34:17.649379 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:34:17.649379 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:34:17.649379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:17.681208 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:34:19.110626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:fa136e51-d041-40b7-a4fb-6ac051cf9f65&page=queryresults
[0m18:34:19.970709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bea529-8927-4c23-b716-28b281aa4cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81D95EB70>]}
[0m18:34:19.970709 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m18:34:19.970709 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:34:19.970709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:19.970709 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:34:19.970709 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:34:19.970709 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:34:19.970709 [info ] [MainThread]: 
[0m18:34:19.970709 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m18:34:19.970709 [debug] [MainThread]: Command end result
[0m18:34:20.003510 [info ] [MainThread]: 
[0m18:34:20.003510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:34:20.003510 [info ] [MainThread]: 
[0m18:34:20.003510 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "PARSE_JSON" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:34:20.003510 [info ] [MainThread]: 
[0m18:34:20.013248 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:34:20.014869 [debug] [MainThread]: Command `dbt run` failed at 18:34:20.014869 after 11.77 seconds
[0m18:34:20.014869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E805E51D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81C33F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81C0D27B0>]}
[0m18:34:20.014869 [debug] [MainThread]: Flushing usage events
[0m18:34:49.483922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE71F735F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE71F73800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE71F73AA0>]}


============================== 18:34:49.501276 | 8fcd9a22-ba92-49e8-b4fa-7bf02863c726 ==============================
[0m18:34:49.501276 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:34:49.502275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:34:50.819161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE04D170B0>]}
[0m18:34:50.882710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE055525D0>]}
[0m18:34:50.882710 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:34:50.898424 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:34:51.036969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:51.036969 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:34:51.238919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE056B6480>]}
[0m18:34:51.317641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE05739CD0>]}
[0m18:34:51.317641 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:34:51.317641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE053F6930>]}
[0m18:34:51.317641 [info ] [MainThread]: 
[0m18:34:51.317641 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:34:51.317641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:34:51.333264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:54.186546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:34:54.186546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:55.449846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE05A41C70>]}
[0m18:34:55.449846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:55.449846 [info ] [MainThread]: 
[0m18:34:55.449846 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:34:55.457879 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:34:55.458845 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:34:55.459431 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:34:55.465724 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:34:55.465724 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:34:55.498547 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:34:55.499319 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:55.535746 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
    JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:34:56.760900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:132848f4-520a-4c66-8270-76698922ed88&page=queryresults
[0m18:34:56.760900 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]')
[0m18:34:57.841434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:a553dffd-c2f3-49dc-81d8-81f5434b9576&page=queryresults
[0m18:34:57.841434 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:a553dffd-c2f3-49dc-81d8-81f5434b9576&page=queryresults
[0m18:34:57.841434 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:34:57.841434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE71683860>]}
[0m18:34:57.841434 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 2.38s]
[0m18:34:57.841434 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:34:57.841434 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:34:57.854028 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:34:57.854829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:34:57.854829 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:34:57.854829 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:34:57.854829 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:34:57.854829 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:34:57.854829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:57.897546 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:35:00.151479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:b1136728-e5de-41fd-bd06-e64ddc88e1f3&page=queryresults
[0m18:35:01.041872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE04B78A70>]}
[0m18:35:01.041872 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 3.19s]
[0m18:35:01.041872 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:35:01.041872 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:35:01.041872 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:35:01.041872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:35:01.041872 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:35:01.041872 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:35:01.057561 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:35:01.060314 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:35:01.061929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:01.097590 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:35:02.516369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:90d3a392-c7e1-42c8-aaf2-1c5b100031ed&page=queryresults
[0m18:35:03.346821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fcd9a22-ba92-49e8-b4fa-7bf02863c726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE059F9D60>]}
[0m18:35:03.346821 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.30s]
[0m18:35:03.346821 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:35:03.346821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:03.346821 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:35:03.346821 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:35:03.346821 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:35:03.346821 [info ] [MainThread]: 
[0m18:35:03.360837 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 12.03 seconds (12.03s).
[0m18:35:03.363218 [debug] [MainThread]: Command end result
[0m18:35:03.383622 [info ] [MainThread]: 
[0m18:35:03.383622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:03.383622 [info ] [MainThread]: 
[0m18:35:03.383622 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Syntax error: Unexpected identifier "JSON_VALUE" at [14:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:35:03.383622 [info ] [MainThread]: 
[0m18:35:03.397650 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:35:03.398731 [debug] [MainThread]: Command `dbt run` failed at 18:35:03.398731 after 14.01 seconds
[0m18:35:03.398731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE04D71790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE71B48B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7142AC60>]}
[0m18:35:03.398731 [debug] [MainThread]: Flushing usage events
[0m18:35:30.057599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C01F913AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C01F9139E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C01F9138F0>]}


============================== 18:35:30.057599 | aab8945b-c544-423a-b9b6-18d4def080a0 ==============================
[0m18:35:30.057599 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:35:30.057599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:35:31.544925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C032EC6B70>]}
[0m18:35:31.607424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C01F958560>]}
[0m18:35:31.607424 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:35:31.624732 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:35:31.732790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:31.732790 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:35:31.938560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C032683A10>]}
[0m18:35:32.018214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C032FBFD70>]}
[0m18:35:32.018214 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:35:32.018214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C033321B50>]}
[0m18:35:32.025222 [info ] [MainThread]: 
[0m18:35:32.025222 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:32.032231 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:35:32.033615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:33.256521 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:35:33.256521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:34.572913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03322AC60>]}
[0m18:35:34.572913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:34.572913 [info ] [MainThread]: 
[0m18:35:34.572913 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:35:34.572913 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:35:34.572913 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:35:34.572913 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:35:34.590698 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:35:34.590698 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:35:34.616905 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:35:34.616905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:34.656466 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_VALUE(offer.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:35:36.816503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8f088f73-52ca-4061-8ac9-25ea447bed6a&page=queryresults
[0m18:35:37.238274 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [29:16]; reason: invalidQuery, location: query, message: Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [29:16]')
[0m18:35:38.101799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:9a24f5a6-bae6-45e4-a358-f90f6d60fe32&page=queryresults
[0m18:35:38.478166 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:9a24f5a6-bae6-45e4-a358-f90f6d60fe32&page=queryresults
[0m18:35:38.493711 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [29:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:35:38.493711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0333964E0>]}
[0m18:35:38.493711 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 3.92s]
[0m18:35:38.493711 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:35:38.493711 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:35:38.504615 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:35:38.505040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:35:38.505040 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:35:38.505040 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:35:38.505040 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:35:38.505040 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:35:38.515006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:38.550849 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:35:40.264525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ef3bd3fa-f69b-4a7a-9411-7795469bffef&page=queryresults
[0m18:35:41.439864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0324286B0>]}
[0m18:35:41.439864 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 2.93s]
[0m18:35:41.442873 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:35:41.442873 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:35:41.442873 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:35:41.442873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:35:41.442873 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:35:41.442873 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:35:41.442873 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:35:41.442873 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:35:41.442873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:41.483438 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:35:43.117794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:78971fcd-08ce-481f-a8df-b1e09ffe9c37&page=queryresults
[0m18:35:44.105882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab8945b-c544-423a-b9b6-18d4def080a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03480BDA0>]}
[0m18:35:44.105882 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.66s]
[0m18:35:44.105882 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:35:44.105882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:44.105882 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:35:44.105882 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:35:44.121508 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:35:44.121508 [info ] [MainThread]: 
[0m18:35:44.121508 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 12.10 seconds (12.10s).
[0m18:35:44.121508 [debug] [MainThread]: Command end result
[0m18:35:44.149646 [info ] [MainThread]: 
[0m18:35:44.155494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:44.155494 [info ] [MainThread]: 
[0m18:35:44.156788 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [29:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:35:44.156788 [info ] [MainThread]: 
[0m18:35:44.156788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:35:44.156788 [debug] [MainThread]: Command `dbt run` failed at 18:35:44.156788 after 14.21 seconds
[0m18:35:44.156788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C033327B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C033153EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C032FBC2F0>]}
[0m18:35:44.156788 [debug] [MainThread]: Flushing usage events
[0m18:38:07.959233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234519E1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234519E30B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234519E20F0>]}


============================== 18:38:07.959233 | 75f33af2-3b10-4be7-a339-aaf9eb105561 ==============================
[0m18:38:07.959233 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:38:07.959233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:09.446085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344F516990>]}
[0m18:38:09.508584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234649394F0>]}
[0m18:38:09.508584 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:38:09.508584 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:38:09.635215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:09.635215 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:38:09.872590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234654C7E60>]}
[0m18:38:09.947588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346515FB60>]}
[0m18:38:09.947588 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:38:09.947588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023464794C80>]}
[0m18:38:09.947588 [info ] [MainThread]: 
[0m18:38:09.947588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:38:09.947588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:38:09.947588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:11.231404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:38:11.231404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:12.597795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346515FF20>]}
[0m18:38:12.597795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:12.597795 [info ] [MainThread]: 
[0m18:38:12.613338 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:38:12.613338 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:38:12.615925 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:38:12.616312 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:38:12.619959 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:38:12.619959 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:38:12.637611 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:38:12.637611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:12.687860 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        PARSE_JSON(offer.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        PARSE_JSON(offer.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data as offer
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:38:14.369867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:cae722e7-9fd1-461a-853b-697d2f4a86cb&page=queryresults
[0m18:38:14.792669 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name AnyOfferChangedNotification not found inside offer at [14:26]; reason: invalidQuery, location: query, message: Name AnyOfferChangedNotification not found inside offer at [14:26]')
[0m18:38:15.864930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2446fc82-9788-40f4-af0a-d8ffd114b33e&page=queryresults
[0m18:38:16.455155 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2446fc82-9788-40f4-af0a-d8ffd114b33e&page=queryresults
[0m18:38:16.455155 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Name AnyOfferChangedNotification not found inside offer at [14:26]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:38:16.455155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234511C7620>]}
[0m18:38:16.455155 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 3.84s]
[0m18:38:16.471203 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:38:16.471886 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:38:16.474485 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:38:16.475520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:38:16.475520 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:38:16.478657 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:38:16.480716 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:38:16.485196 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:38:16.487284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:16.521915 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:38:18.087137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:b611806c-dfcc-426b-a63a-dade79f6af4f&page=queryresults
[0m18:38:18.980704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234645C8800>]}
[0m18:38:18.980704 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m18:38:18.980704 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:38:18.980704 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:38:18.980704 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:38:18.980704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:38:18.980704 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:38:18.980704 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:38:18.996446 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:38:18.998607 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:38:19.001968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:19.036719 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:38:20.426112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0e80adb1-bd85-492b-a230-0202045d6be6&page=queryresults
[0m18:38:21.286552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f33af2-3b10-4be7-a339-aaf9eb105561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346552FD70>]}
[0m18:38:21.286552 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m18:38:21.286552 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:38:21.286552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:21.286552 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:38:21.286552 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:38:21.286552 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:38:21.286552 [info ] [MainThread]: 
[0m18:38:21.286552 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 11.34 seconds (11.34s).
[0m18:38:21.286552 [debug] [MainThread]: Command end result
[0m18:38:21.338489 [info ] [MainThread]: 
[0m18:38:21.338489 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:38:21.338489 [info ] [MainThread]: 
[0m18:38:21.338489 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Name AnyOfferChangedNotification not found inside offer at [14:26]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:38:21.338489 [info ] [MainThread]: 
[0m18:38:21.338489 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:38:21.338489 [debug] [MainThread]: Command `dbt run` failed at 18:38:21.338489 after 13.55 seconds
[0m18:38:21.338489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234519BDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234653046B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023464FA3E90>]}
[0m18:38:21.338489 [debug] [MainThread]: Flushing usage events
[0m18:38:54.850301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F2B00260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F55EE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F55ED3A0>]}


============================== 18:38:54.850301 | 46e0fc56-a500-4806-87f3-b6177ea3ae0b ==============================
[0m18:38:54.850301 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:38:54.860808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:38:56.193861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221882E70B0>]}
[0m18:38:56.241631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F45F4C50>]}
[0m18:38:56.241631 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:38:56.257356 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:38:56.370362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:56.370362 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:38:56.574994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022189047EF0>]}
[0m18:38:56.638790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022188D2A2A0>]}
[0m18:38:56.638790 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:38:56.638790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022189018A70>]}
[0m18:38:56.654398 [info ] [MainThread]: 
[0m18:38:56.654398 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:38:56.654398 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:38:56.654398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:57.887677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:38:57.888779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:59.157767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221882E7020>]}
[0m18:38:59.157767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:59.157767 [info ] [MainThread]: 
[0m18:38:59.157767 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:38:59.157767 [info ] [Thread-1 (]: 1 of 3 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:38:59.157767 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:38:59.157767 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:38:59.175026 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:38:59.175026 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:38:59.211087 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:38:59.213228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:59.252899 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        PARSE_JSON(offer.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        PARSE_JSON(offer.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data as offer
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:39:00.867815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:856a8f9d-857c-4f22-9b4a-caa15ab3e875&page=queryresults
[0m18:39:01.600697 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Payload not found inside offer at [14:26]; reason: invalidQuery, location: query, message: Name Payload not found inside offer at [14:26]')
[0m18:39:02.841960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:630f1bdd-5647-494e-bf9c-e7b666c055d8&page=queryresults
[0m18:39:03.345802 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:630f1bdd-5647-494e-bf9c-e7b666c055d8&page=queryresults
[0m18:39:03.361313 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Name Payload not found inside offer at [14:26]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:39:03.361313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F4CD7710>]}
[0m18:39:03.361313 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 4.20s]
[0m18:39:03.361313 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:39:03.369600 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m18:39:03.370314 [info ] [Thread-1 (]: 2 of 3 START sql view model wellbefore.src_notifications ....................... [RUN]
[0m18:39:03.370536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notifications)
[0m18:39:03.370536 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m18:39:03.370536 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m18:39:03.370536 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m18:39:03.370536 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m18:39:03.370536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:03.404531 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m18:39:05.005096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:a4023b32-5b83-4115-9dcd-6ba5cf934739&page=queryresults
[0m18:39:06.762374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218A4C87D0>]}
[0m18:39:06.762374 [info ] [Thread-1 (]: 2 of 3 OK created sql view model wellbefore.src_notifications .................. [[32mCREATE VIEW (0 processed)[0m in 3.39s]
[0m18:39:06.762374 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m18:39:06.762374 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_orders
[0m18:39:06.762374 [info ] [Thread-1 (]: 3 of 3 START sql view model wellbefore.src_orders .............................. [RUN]
[0m18:39:06.762374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_orders)
[0m18:39:06.762374 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_orders
[0m18:39:06.762374 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_orders"
[0m18:39:06.778089 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_orders
[0m18:39:06.778089 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_orders"
[0m18:39:06.778089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:06.810705 [debug] [Thread-1 (]: On model.buy_box_gcp.src_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_orders"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_orders`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:39:08.190070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:659bfcd1-8268-4f81-bc07-62d491a12686&page=queryresults
[0m18:39:09.035536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e0fc56-a500-4806-87f3-b6177ea3ae0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218A4CA180>]}
[0m18:39:09.035536 [info ] [Thread-1 (]: 3 of 3 OK created sql view model wellbefore.src_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m18:39:09.051263 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_orders
[0m18:39:09.053879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:09.053879 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:39:09.053879 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:39:09.055134 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_orders' was properly closed.
[0m18:39:09.055134 [info ] [MainThread]: 
[0m18:39:09.056226 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 12.40 seconds (12.40s).
[0m18:39:09.057468 [debug] [MainThread]: Command end result
[0m18:39:09.088265 [info ] [MainThread]: 
[0m18:39:09.088265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:09.088265 [info ] [MainThread]: 
[0m18:39:09.088265 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Name Payload not found inside offer at [14:26]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:39:09.088265 [info ] [MainThread]: 
[0m18:39:09.088265 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:39:09.088265 [debug] [MainThread]: Command `dbt run` failed at 18:39:09.088265 after 14.35 seconds
[0m18:39:09.088265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F55ED070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218A4D3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022188CB2510>]}
[0m18:39:09.088265 [debug] [MainThread]: Flushing usage events
[0m18:40:23.550193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB1A763920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB199A1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB1A763890>]}


============================== 18:40:23.555238 | 2c78f623-b0cd-4bad-98db-0a76e4731b05 ==============================
[0m18:40:23.555238 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:40:23.556273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select src_buybox_offers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:24.790614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB181CA4E0>]}
[0m18:40:24.853566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB1A6921E0>]}
[0m18:40:24.853566 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:40:24.872889 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:40:24.989084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:24.989084 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:40:25.207595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB2E177E90>]}
[0m18:40:25.278526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB2DE59B80>]}
[0m18:40:25.278526 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:40:25.278526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB2E1727B0>]}
[0m18:40:25.278526 [info ] [MainThread]: 
[0m18:40:25.278526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:40:25.278526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:40:25.278526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:26.703407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:40:26.703407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:28.198491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB2DBB86B0>]}
[0m18:40:28.201506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:28.202521 [info ] [MainThread]: 
[0m18:40:28.205550 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:40:28.206082 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:40:28.207120 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:40:28.207718 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:40:28.213541 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:40:28.215103 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:40:28.240481 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:40:28.248526 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:40:28.296294 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        PARSE_JSON(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        PARSE_JSON(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:40:29.808669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3310ad48-e0b5-43c7-9a1e-fe3aa0b38871&page=queryresults
[0m18:40:30.248426 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]; reason: invalidQuery, location: query, message: No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]')
[0m18:40:31.597705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c19223c0-4c7e-4a97-a578-2b51345f0f6b&page=queryresults
[0m18:40:32.004300 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c19223c0-4c7e-4a97-a578-2b51345f0f6b&page=queryresults
[0m18:40:32.023682 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:40:32.023682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c78f623-b0cd-4bad-98db-0a76e4731b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB19E737D0>]}
[0m18:40:32.023682 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 3.82s]
[0m18:40:32.023682 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:40:32.023682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:32.023682 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:40:32.023682 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:40:32.023682 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_buybox_offers' was properly closed.
[0m18:40:32.023682 [info ] [MainThread]: 
[0m18:40:32.023682 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m18:40:32.023682 [debug] [MainThread]: Command end result
[0m18:40:32.058362 [info ] [MainThread]: 
[0m18:40:32.058362 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:40:32.058362 [info ] [MainThread]: 
[0m18:40:32.071608 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:40:32.073172 [info ] [MainThread]: 
[0m18:40:32.073172 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:40:32.073172 [debug] [MainThread]: Command `dbt run` failed at 18:40:32.073172 after 8.71 seconds
[0m18:40:32.073172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB197B7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB19E36900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB2D316CC0>]}
[0m18:40:32.073172 [debug] [MainThread]: Flushing usage events
[0m18:40:58.720831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B4C91100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B754A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B76407A0>]}


============================== 18:40:58.720831 | fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2 ==============================
[0m18:40:58.720831 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:40:58.720831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select src_buybox_offers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:00.008856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CACDB2C0>]}
[0m18:41:00.068811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B74AA1E0>]}
[0m18:41:00.068811 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:41:00.068811 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:41:00.188072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:00.188072 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:41:00.392899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CAF31250>]}
[0m18:41:00.472492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CAFE9BE0>]}
[0m18:41:00.472492 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:41:00.472492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CB1277A0>]}
[0m18:41:00.472492 [info ] [MainThread]: 
[0m18:41:00.472492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:41:00.472492 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:41:00.472492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:01.715914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:41:01.715914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:02.972662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B6FE2450>]}
[0m18:41:02.972662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:02.972662 [info ] [MainThread]: 
[0m18:41:02.972662 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:41:02.972662 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:41:02.972662 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:41:02.972662 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:41:02.982413 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:41:02.988858 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:41:03.007544 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:41:03.007544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:03.053869 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        PARSE_JSON(data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        PARSE_JSON(data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:41:04.616373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d8d2c9dc-8019-4ec9-8d52-5e1e3c4a6baa&page=queryresults
[0m18:41:05.340575 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: data at [14:20]; reason: invalidQuery, location: query, message: Unrecognized name: data at [14:20]')
[0m18:41:06.906003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:242261b8-1be6-4d88-b93d-0b64686bd682&page=queryresults
[0m18:41:07.516195 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:242261b8-1be6-4d88-b93d-0b64686bd682&page=queryresults
[0m18:41:07.516195 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Unrecognized name: data at [14:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:41:07.516195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2d41d9-c36e-4f1a-98cd-2b5c6c1e10e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CC6A3770>]}
[0m18:41:07.516195 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 4.54s]
[0m18:41:07.531827 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:41:07.534170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:07.534170 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:41:07.534170 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:41:07.534170 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_buybox_offers' was properly closed.
[0m18:41:07.534170 [info ] [MainThread]: 
[0m18:41:07.534170 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m18:41:07.534170 [debug] [MainThread]: Command end result
[0m18:41:07.556878 [info ] [MainThread]: 
[0m18:41:07.556878 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:41:07.571386 [info ] [MainThread]: 
[0m18:41:07.572269 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Unrecognized name: data at [14:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:41:07.573341 [info ] [MainThread]: 
[0m18:41:07.573875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:07.573875 [debug] [MainThread]: Command `dbt run` failed at 18:41:07.573875 after 8.96 seconds
[0m18:41:07.573875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B760D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2CB18B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B6D3C2C0>]}
[0m18:41:07.573875 [debug] [MainThread]: Flushing usage events
[0m18:41:50.190812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C460847260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C462DC5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4632DFFB0>]}


============================== 18:41:50.194476 | 65335731-20fe-480c-ac19-ab884e97e6b3 ==============================
[0m18:41:50.194476 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:41:50.195524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_buybox_offers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:41:51.449243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4768664E0>]}
[0m18:41:51.511809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4608EE060>]}
[0m18:41:51.523827 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:41:51.527870 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:41:51.639963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:51.639963 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:41:51.856015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C476CC7DA0>]}
[0m18:41:51.923829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C476989C10>]}
[0m18:41:51.923829 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:41:51.934920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C476CC2810>]}
[0m18:41:51.934920 [info ] [MainThread]: 
[0m18:41:51.934920 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:41:51.934920 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:41:51.934920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:53.174211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:41:53.174211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:54.537201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C463328920>]}
[0m18:41:54.537201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:54.537201 [info ] [MainThread]: 
[0m18:41:54.537201 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:41:54.537201 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:41:54.537201 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:41:54.537201 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:41:54.537201 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:41:54.537201 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:41:54.592098 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:41:54.607677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:54.641054 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        PARSE_JSON(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        PARSE_JSON(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:41:56.183569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:1d007550-01df-48b2-83cc-254ed0e3b44a&page=queryresults
[0m18:41:56.600244 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]; reason: invalidQuery, location: query, message: No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]')
[0m18:41:57.408276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ca3c6371-68c8-4206-9ffd-cdba62519a0e&page=queryresults
[0m18:41:57.799259 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ca3c6371-68c8-4206-9ffd-cdba62519a0e&page=queryresults
[0m18:41:57.799259 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:41:57.799259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65335731-20fe-480c-ac19-ab884e97e6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C476D31AF0>]}
[0m18:41:57.799259 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 3.26s]
[0m18:41:57.799259 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:41:57.815378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:57.815378 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:41:57.815378 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:41:57.815378 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_buybox_offers' was properly closed.
[0m18:41:57.815378 [info ] [MainThread]: 
[0m18:41:57.815378 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m18:41:57.815378 [debug] [MainThread]: Command end result
[0m18:41:57.858477 [info ] [MainThread]: 
[0m18:41:57.858477 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:41:57.858477 [info ] [MainThread]: 
[0m18:41:57.858477 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:41:57.858477 [info ] [MainThread]: 
[0m18:41:57.858477 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:57.858477 [debug] [MainThread]: Command `dbt run` failed at 18:41:57.858477 after 7.79 seconds
[0m18:41:57.858477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C476A1CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4632FBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4632F84D0>]}
[0m18:41:57.858477 [debug] [MainThread]: Flushing usage events
[0m18:42:39.884638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D3CC7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10CAD9EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B108EED040>]}


============================== 18:42:39.887847 | 27e44ce7-2515-4bdd-9dd7-96b83f443964 ==============================
[0m18:42:39.887847 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:42:39.887847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_buybox_offers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:42:41.392237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D567BF0>]}
[0m18:42:41.455183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B120125940>]}
[0m18:42:41.455183 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:42:41.455183 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:42:41.574592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:41.574592 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:42:41.785989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11FAF0500>]}
[0m18:42:41.864307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B120F393D0>]}
[0m18:42:41.864307 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:42:41.864307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B120F63B60>]}
[0m18:42:41.864307 [info ] [MainThread]: 
[0m18:42:41.864307 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:42:41.864307 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:42:41.864307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:43.088986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:42:43.088986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:44.414933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B120B90AD0>]}
[0m18:42:44.414933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:44.414933 [info ] [MainThread]: 
[0m18:42:44.414933 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:42:44.421022 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:42:44.422519 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:42:44.422920 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:42:44.426381 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:42:44.426381 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:42:44.476610 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:42:44.476610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:44.516728 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:42:45.988285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:39a867bd-1fc2-471b-be95-90b821c20525&page=queryresults
[0m18:42:46.397917 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [28:16]; reason: invalidQuery, location: query, message: Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [28:16]')
[0m18:42:47.539518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:abe15130-e292-49c1-b16b-423be8b0cf1a&page=queryresults
[0m18:42:47.933438 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:abe15130-e292-49c1-b16b-423be8b0cf1a&page=queryresults
[0m18:42:47.933438 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [28:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:42:47.933438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e44ce7-2515-4bdd-9dd7-96b83f443964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B120FD78C0>]}
[0m18:42:47.933438 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 3.51s]
[0m18:42:47.933438 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:42:47.949121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:47.949121 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:42:47.949121 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:42:47.949121 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_buybox_offers' was properly closed.
[0m18:42:47.949121 [info ] [MainThread]: 
[0m18:42:47.949121 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m18:42:47.949121 [debug] [MainThread]: Command end result
[0m18:42:47.975968 [info ] [MainThread]: 
[0m18:42:47.975968 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:42:47.975968 [info ] [MainThread]: 
[0m18:42:47.975968 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  Values referenced in UNNEST must be arrays. UNNEST contains expression of type STRING at [28:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:42:47.975968 [info ] [MainThread]: 
[0m18:42:47.975968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:42:47.975968 [debug] [MainThread]: Command `dbt run` failed at 18:42:47.975968 after 8.23 seconds
[0m18:42:47.975968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10CAD9EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B120DB7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10CC339E0>]}
[0m18:42:47.975968 [debug] [MainThread]: Flushing usage events
[0m18:43:03.118312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13EF6C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1418D88F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1418DB590>]}


============================== 18:43:03.118312 | b084da74-dfa9-400d-bbe8-d13c9207c196 ==============================
[0m18:43:03.118312 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:43:03.118312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select src_buybox_offers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:43:04.529206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1548770B0>]}
[0m18:43:04.592126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F141AA4A70>]}
[0m18:43:04.592126 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:43:04.592126 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:43:04.724487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:04.740113 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:43:04.969834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F155081250>]}
[0m18:43:05.045199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F155118590>]}
[0m18:43:05.045199 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:43:05.059210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F155082450>]}
[0m18:43:05.059210 [info ] [MainThread]: 
[0m18:43:05.061220 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:05.061220 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:43:05.061220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:06.270412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:43:06.270412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:07.534297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1551D4560>]}
[0m18:43:07.534297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:07.535298 [info ] [MainThread]: 
[0m18:43:07.537975 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:43:07.539016 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:43:07.540016 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:43:07.540016 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:43:07.545785 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:43:07.547787 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:43:07.576342 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:43:07.579550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:07.620004 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        PARSE_JSON(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        PARSE_JSON(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:43:09.104567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:34ad563c-00ce-4175-8b86-ab8e78c90caa&page=queryresults
[0m18:43:09.527249 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]; reason: invalidQuery, location: query, message: No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]')
[0m18:43:10.735750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:7daae7d3-6ae6-4144-8036-668c6f65d38e&page=queryresults
[0m18:43:11.160039 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:7daae7d3-6ae6-4144-8036-668c6f65d38e&page=queryresults
[0m18:43:11.166068 [debug] [Thread-1 (]: Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:43:11.166068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b084da74-dfa9-400d-bbe8-d13c9207c196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F141143A40>]}
[0m18:43:11.166068 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_buybox_offers .............. [[31mERROR[0m in 3.63s]
[0m18:43:11.166068 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:43:11.177649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:11.179038 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:43:11.179038 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:43:11.179038 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_buybox_offers' was properly closed.
[0m18:43:11.179038 [info ] [MainThread]: 
[0m18:43:11.179038 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m18:43:11.183614 [debug] [MainThread]: Command end result
[0m18:43:11.210287 [info ] [MainThread]: 
[0m18:43:11.210287 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:43:11.210287 [info ] [MainThread]: 
[0m18:43:11.210287 [error] [MainThread]:   Database Error in model src_buybox_offers (models\src\src_buybox_offers.sql)
  No matching signature for function PARSE_JSON for argument types: JSON. Supported signature: PARSE_JSON(STRING, [wide_number_mode => STRING]) at [14:9]
  compiled Code at target\run\buy_box_gcp\models\src\src_buybox_offers.sql
[0m18:43:11.210287 [info ] [MainThread]: 
[0m18:43:11.225915 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:43:11.225915 [debug] [MainThread]: Command `dbt run` failed at 18:43:11.225915 after 8.21 seconds
[0m18:43:11.228621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15501F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1551ACB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1418D9EB0>]}
[0m18:43:11.229482 [debug] [MainThread]: Flushing usage events
[0m18:44:08.783869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF36002C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF5D39EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF5F6F5F0>]}


============================== 18:44:08.783869 | 697635b2-118f-44df-afa5-424a5b6829ad ==============================
[0m18:44:08.783869 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:44:08.783869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_buybox_offers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:10.069944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF61393D0>]}
[0m18:44:10.132643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FD88FCAB10>]}
[0m18:44:10.132643 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:44:10.153647 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:44:10.261520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:10.261520 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m18:44:10.476637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FD89B6FA70>]}
[0m18:44:10.564985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FD8980F140>]}
[0m18:44:10.565593 [info ] [MainThread]: Found 1 seed, 3 models, 478 macros
[0m18:44:10.566103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF60EFE90>]}
[0m18:44:10.567741 [info ] [MainThread]: 
[0m18:44:10.568810 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:44:10.570418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:44:10.570949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:11.843546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:44:11.843546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:13.103769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FD899AA0C0>]}
[0m18:44:13.103769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:13.103769 [info ] [MainThread]: 
[0m18:44:13.103769 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m18:44:13.103769 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_buybox_offers ....................... [RUN]
[0m18:44:13.103769 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m18:44:13.103769 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m18:44:13.121149 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m18:44:13.126478 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m18:44:13.151215 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m18:44:13.160737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:13.194060 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m18:44:14.788703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ae613dd9-fbfe-4d53-a2cb-384381bd03e4&page=queryresults
[0m18:44:15.655109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '697635b2-118f-44df-afa5-424a5b6829ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FD88C6FE60>]}
[0m18:44:15.655109 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_buybox_offers .................. [[32mCREATE VIEW (0 processed)[0m in 2.55s]
[0m18:44:15.655109 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m18:44:15.655109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:15.655109 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:44:15.655109 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:44:15.655109 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_buybox_offers' was properly closed.
[0m18:44:15.665416 [info ] [MainThread]: 
[0m18:44:15.666303 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m18:44:15.667261 [debug] [MainThread]: Command end result
[0m18:44:15.695403 [info ] [MainThread]: 
[0m18:44:15.695403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:15.695403 [info ] [MainThread]: 
[0m18:44:15.695403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:15.695403 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:15.695403 after 7.04 seconds
[0m18:44:15.695403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF36002C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF5E30890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FDF5CB91F0>]}
[0m18:44:15.695403 [debug] [MainThread]: Flushing usage events
[0m18:59:14.420167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3997E9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39981DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3997E92B0>]}


============================== 18:59:14.420167 | 593caf37-b391-4de3-afc6-9484f6714183 ==============================
[0m18:59:14.420167 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:59:14.420167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select src_notification_lowest_prices', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:59:15.762160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ACCB8770>]}
[0m18:59:15.810775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC632240>]}
[0m18:59:15.810775 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:59:15.826500 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:59:15.930964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:59:15.930964 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_notification_lowest_prices.sql
[0m18:59:16.151665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AD3384A0>]}
[0m18:59:16.227565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AD30E5A0>]}
[0m18:59:16.227565 [info ] [MainThread]: Found 1 seed, 4 models, 478 macros
[0m18:59:16.227565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC604470>]}
[0m18:59:16.227565 [info ] [MainThread]: 
[0m18:59:16.227565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:59:16.227565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:59:16.227565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:17.672684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:59:17.672684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:18.904591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AD0D6F30>]}
[0m18:59:18.904591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:18.904591 [info ] [MainThread]: 
[0m18:59:18.921742 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m18:59:18.921742 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_notification_lowest_prices .......... [RUN]
[0m18:59:18.921742 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notification_lowest_prices'
[0m18:59:18.921742 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m18:59:18.931422 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m18:59:18.931422 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m18:59:18.948090 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m18:59:18.964691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:59:19.004359 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.Condition.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.Condition.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(bop) AS lp
)

SELECT * FROM flatten_data_1;


[0m18:59:20.641155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:b5cf2653-611c-4539-be8f-3cfb06327397&page=queryresults
[0m18:59:21.079310 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: bop at [32:16]; reason: invalidQuery, location: query, message: Unrecognized name: bop at [32:16]')
[0m18:59:22.358065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c8796c2d-dfa2-4d9e-93a0-89d189261a00&page=queryresults
[0m18:59:22.772341 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c8796c2d-dfa2-4d9e-93a0-89d189261a00&page=queryresults
[0m18:59:22.794479 [debug] [Thread-1 (]: Database Error in model src_notification_lowest_prices (models\src\src_notification_lowest_prices.sql)
  Unrecognized name: bop at [32:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_lowest_prices.sql
[0m18:59:22.794479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593caf37-b391-4de3-afc6-9484f6714183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AD3A69F0>]}
[0m18:59:22.794479 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_notification_lowest_prices . [[31mERROR[0m in 3.87s]
[0m18:59:22.794479 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m18:59:22.801777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:22.801777 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:59:22.801777 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:59:22.801777 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_notification_lowest_prices' was properly closed.
[0m18:59:22.801777 [info ] [MainThread]: 
[0m18:59:22.801777 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m18:59:22.801777 [debug] [MainThread]: Command end result
[0m18:59:22.832027 [info ] [MainThread]: 
[0m18:59:22.832027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:59:22.832027 [info ] [MainThread]: 
[0m18:59:22.832027 [error] [MainThread]:   Database Error in model src_notification_lowest_prices (models\src\src_notification_lowest_prices.sql)
  Unrecognized name: bop at [32:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_lowest_prices.sql
[0m18:59:22.832027 [info ] [MainThread]: 
[0m18:59:22.832027 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:59:22.832027 [debug] [MainThread]: Command `dbt run` failed at 18:59:22.832027 after 8.59 seconds
[0m18:59:22.832027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39964DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AD18EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3997BDDC0>]}
[0m18:59:22.832027 [debug] [MainThread]: Flushing usage events
[0m19:00:01.521444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BADEEB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BA8224A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BADEE87D0>]}


============================== 19:00:01.525447 | 5178adc9-cbe2-40a4-b9c5-5be046f9b6a0 ==============================
[0m19:00:01.525447 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:00:01.525447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_notification_lowest_prices', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:00:02.789799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAE0B9250>]}
[0m19:00:02.852309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAE0B8EC0>]}
[0m19:00:02.852309 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:00:02.859819 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:00:02.980698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:02.980698 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_lowest_prices.sql
[0m19:00:03.220029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BC1A642F0>]}
[0m19:00:03.291105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BC17B87D0>]}
[0m19:00:03.291105 [info ] [MainThread]: Found 1 seed, 4 models, 478 macros
[0m19:00:03.291105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BC1A452E0>]}
[0m19:00:03.291105 [info ] [MainThread]: 
[0m19:00:03.291105 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:03.291105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m19:00:03.291105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:04.736482 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m19:00:04.736482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:06.060300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BC1969940>]}
[0m19:00:06.060825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:06.061348 [info ] [MainThread]: 
[0m19:00:06.063967 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:06.063967 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_notification_lowest_prices .......... [RUN]
[0m19:00:06.063967 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notification_lowest_prices'
[0m19:00:06.063967 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:06.069817 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m19:00:06.069817 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:06.099516 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m19:00:06.099516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:06.149085 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.Condition.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.Condition.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m19:00:07.689612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:bc03ec63-5da4-451d-bd02-cde42c67f7a0&page=queryresults
[0m19:00:08.341647 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name LandedPriceAmount at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name LandedPriceAmount at [6:6]')
[0m19:00:09.896332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c664772a-6e4a-430e-b49f-d94b83bd47ad&page=queryresults
[0m19:00:10.312246 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c664772a-6e4a-430e-b49f-d94b83bd47ad&page=queryresults
[0m19:00:10.328135 [debug] [Thread-1 (]: Database Error in model src_notification_lowest_prices (models\src\src_notification_lowest_prices.sql)
  CREATE VIEW has columns with duplicate name LandedPriceAmount at [6:6]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_lowest_prices.sql
[0m19:00:10.328135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5178adc9-cbe2-40a4-b9c5-5be046f9b6a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAD757830>]}
[0m19:00:10.328135 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_notification_lowest_prices . [[31mERROR[0m in 4.26s]
[0m19:00:10.328135 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:10.337080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:10.337080 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m19:00:10.337080 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m19:00:10.337080 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_notification_lowest_prices' was properly closed.
[0m19:00:10.337080 [info ] [MainThread]: 
[0m19:00:10.337080 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m19:00:10.337080 [debug] [MainThread]: Command end result
[0m19:00:10.368407 [info ] [MainThread]: 
[0m19:00:10.381254 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:10.382262 [info ] [MainThread]: 
[0m19:00:10.383417 [error] [MainThread]:   Database Error in model src_notification_lowest_prices (models\src\src_notification_lowest_prices.sql)
  CREATE VIEW has columns with duplicate name LandedPriceAmount at [6:6]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_lowest_prices.sql
[0m19:00:10.383417 [info ] [MainThread]: 
[0m19:00:10.384867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:00:10.386976 [debug] [MainThread]: Command `dbt run` failed at 19:00:10.386976 after 8.99 seconds
[0m19:00:10.386976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BA8224A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BC1605CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BC0B781D0>]}
[0m19:00:10.386976 [debug] [MainThread]: Flushing usage events
[0m19:00:40.917704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140ADA94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140A7692B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140A4993A0>]}


============================== 19:00:40.925711 | d18dffae-e16f-432d-a0da-dac982d0a3e0 ==============================
[0m19:00:40.925711 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:00:40.925711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_notification_lowest_prices', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:42.310523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140A0A7B30>]}
[0m19:00:42.373423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140A1BA750>]}
[0m19:00:42.373423 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:00:42.373423 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:00:42.498879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:42.498879 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_lowest_prices.sql
[0m19:00:42.751143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141EA9E480>]}
[0m19:00:42.827740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141E8C9EE0>]}
[0m19:00:42.827740 [info ] [MainThread]: Found 1 seed, 4 models, 478 macros
[0m19:00:42.827740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141E71F6E0>]}
[0m19:00:42.830745 [info ] [MainThread]: 
[0m19:00:42.831724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:42.831724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m19:00:42.831724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:44.068044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m19:00:44.068044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:45.286709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141EBF9F10>]}
[0m19:00:45.287228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:45.288273 [info ] [MainThread]: 
[0m19:00:45.292131 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:45.293278 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_notification_lowest_prices .......... [RUN]
[0m19:00:45.294463 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notification_lowest_prices'
[0m19:00:45.294950 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:45.303244 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m19:00:45.304963 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:45.317688 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m19:00:45.332145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:45.368033 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.Condition.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.Condition.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m19:00:46.864752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:97ea18b8-e8e2-4c3b-b6fb-deb07e1f6dee&page=queryresults
[0m19:00:47.708545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd18dffae-e16f-432d-a0da-dac982d0a3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141E8525D0>]}
[0m19:00:47.708545 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_notification_lowest_prices ..... [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m19:00:47.708545 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m19:00:47.708545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:47.708545 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m19:00:47.708545 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m19:00:47.708545 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_notification_lowest_prices' was properly closed.
[0m19:00:47.708545 [info ] [MainThread]: 
[0m19:00:47.724152 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m19:00:47.724152 [debug] [MainThread]: Command end result
[0m19:00:47.752219 [info ] [MainThread]: 
[0m19:00:47.752219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:47.765457 [info ] [MainThread]: 
[0m19:00:47.765457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:47.767032 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:47.767032 after 6.95 seconds
[0m19:00:47.767032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140ADA94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140A4995E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140A4993A0>]}
[0m19:00:47.767032 [debug] [MainThread]: Flushing usage events
[0m19:03:28.950709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273850C6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387A5F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387A5DCA0>]}


============================== 19:03:28.950709 | b33752ba-f259-453b-8ae3-0435d9c3a5e5 ==============================
[0m19:03:28.950709 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:03:28.950709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_notification_lowest_prices', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:03:30.390311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387C29730>]}
[0m19:03:30.454834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739AA6E5A0>]}
[0m19:03:30.454834 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:03:30.454834 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:03:30.585233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:30.585233 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_lowest_prices.sql
[0m19:03:30.821629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739B125880>]}
[0m19:03:30.904682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739B4CFE00>]}
[0m19:03:30.904682 [info ] [MainThread]: Found 1 seed, 4 models, 478 macros
[0m19:03:30.904682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739B587770>]}
[0m19:03:30.904682 [info ] [MainThread]: 
[0m19:03:30.904682 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:30.904682 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m19:03:30.904682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:32.286567 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m19:03:32.286567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:33.585528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739B586C60>]}
[0m19:03:33.585528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:33.585528 [info ] [MainThread]: 
[0m19:03:33.585528 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m19:03:33.585528 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_notification_lowest_prices .......... [RUN]
[0m19:03:33.585528 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notification_lowest_prices'
[0m19:03:33.585528 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m19:03:33.604019 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m19:03:33.604524 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m19:03:33.621055 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m19:03:33.621055 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:03:33.666592 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m19:03:35.060613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:bb6df129-e910-4344-b66d-81d2b0b1d34e&page=queryresults
[0m19:03:36.106658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b33752ba-f259-453b-8ae3-0435d9c3a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739A6C86B0>]}
[0m19:03:36.112673 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_notification_lowest_prices ..... [[32mCREATE VIEW (0 processed)[0m in 2.52s]
[0m19:03:36.112673 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m19:03:36.114696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:36.114696 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m19:03:36.114696 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m19:03:36.114696 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_notification_lowest_prices' was properly closed.
[0m19:03:36.114696 [info ] [MainThread]: 
[0m19:03:36.114696 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m19:03:36.114696 [debug] [MainThread]: Command end result
[0m19:03:36.138193 [info ] [MainThread]: 
[0m19:03:36.138193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:36.138193 [info ] [MainThread]: 
[0m19:03:36.138193 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:03:36.152456 [debug] [MainThread]: Command `dbt run` succeeded at 19:03:36.152456 after 7.36 seconds
[0m19:03:36.152456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739B36F080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739B25D5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387BFB980>]}
[0m19:03:36.153468 [debug] [MainThread]: Flushing usage events
[0m18:52:22.282943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84C1DA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84B510AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84EDECB30>]}


============================== 18:52:22.297563 | 10ab8967-428c-42f1-a261-37fc21635570 ==============================
[0m18:52:22.297563 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:52:22.298229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_offer_change_trigger', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:24.378603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C862442E70>]}
[0m18:52:24.437243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8623D1D30>]}
[0m18:52:24.438902 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:52:24.448217 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:52:24.627566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:52:24.628567 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_notification_summary.sql
[0m18:52:24.628567 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_offer_change_trigger.sql
[0m18:52:24.840564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C86289AD80>]}
[0m18:52:24.933698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C86264A6F0>]}
[0m18:52:24.933698 [info ] [MainThread]: Found 1 seed, 6 models, 478 macros
[0m18:52:24.934735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C86294D850>]}
[0m18:52:24.935800 [info ] [MainThread]: 
[0m18:52:24.936719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:52:24.936719 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:52:24.937697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:26.583412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:52:26.583412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:27.998172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C862443200>]}
[0m18:52:27.998172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:27.999174 [info ] [MainThread]: 
[0m18:52:28.005684 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m18:52:28.006684 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_offer_change_trigger ................ [RUN]
[0m18:52:28.007692 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_offer_change_trigger'
[0m18:52:28.007692 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m18:52:28.012684 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m18:52:28.014691 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m18:52:28.039701 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m18:52:28.041691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:28.076799 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:52:29.539894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:1b9c8901-aefc-4e7e-a337-341aa8f827bb&page=queryresults
[0m18:52:29.540807 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:52:29.541811 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries was not found in location US; reason: notFound, message: Not found: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries was not found in location US

Location: US
Job ID: 1b9c8901-aefc-4e7e-a337-341aa8f827bb

[0m18:52:29.561807 [debug] [Thread-1 (]: Runtime Error in model src_offer_change_trigger (models\src\src_offer_change_trigger.sql)
  404 Not found: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries was not found in location US; reason: notFound, message: Not found: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries was not found in location US
  
  Location: US
  Job ID: 1b9c8901-aefc-4e7e-a337-341aa8f827bb
  
[0m18:52:29.562799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10ab8967-428c-42f1-a261-37fc21635570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8626BDA90>]}
[0m18:52:29.563805 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_offer_change_trigger ....... [[31mERROR[0m in 1.56s]
[0m18:52:29.564803 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m18:52:29.566720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:29.566720 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:52:29.566720 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:52:29.567805 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_offer_change_trigger' was properly closed.
[0m18:52:29.567805 [info ] [MainThread]: 
[0m18:52:29.568720 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m18:52:29.569729 [debug] [MainThread]: Command end result
[0m18:52:29.614620 [info ] [MainThread]: 
[0m18:52:29.615656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:52:29.616599 [info ] [MainThread]: 
[0m18:52:29.617599 [error] [MainThread]:   Runtime Error in model src_offer_change_trigger (models\src\src_offer_change_trigger.sql)
  404 Not found: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries was not found in location US; reason: notFound, message: Not found: Table dbtproject-439612:wellbefore.BuyBox_raw_ds_first20_entries was not found in location US
  
  Location: US
  Job ID: 1b9c8901-aefc-4e7e-a337-341aa8f827bb
  
[0m18:52:29.620659 [info ] [MainThread]: 
[0m18:52:29.621167 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:52:29.623270 [debug] [MainThread]: Command `dbt run` failed at 18:52:29.622183 after 7.51 seconds
[0m18:52:29.623270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84EA91FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84EB35280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C84EB35100>]}
[0m18:52:29.623270 [debug] [MainThread]: Flushing usage events
[0m18:52:47.933534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22A01E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22C6270B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22C627BC0>]}


============================== 18:52:47.937543 | 3ff93168-353c-4813-b0d8-270799bccbdd ==============================
[0m18:52:47.937543 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:52:47.937543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:52:49.289617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2404CAD80>]}
[0m18:52:49.353296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23FBD74A0>]}
[0m18:52:49.355300 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:52:49.362385 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:52:49.488880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:49.488880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:49.513963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23FE77F50>]}
[0m18:52:49.590402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2405A2A20>]}
[0m18:52:49.590402 [info ] [MainThread]: Found 1 seed, 6 models, 478 macros
[0m18:52:49.591402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2404F7890>]}
[0m18:52:49.593486 [info ] [MainThread]: 
[0m18:52:49.594399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:52:49.595615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:52:49.595615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:50.850935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:52:50.850935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:52.132819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24077B890>]}
[0m18:52:52.133911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:52.134853 [info ] [MainThread]: 
[0m18:52:52.140815 [debug] [Thread-1 (]: Began running node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:52:52.141817 [info ] [Thread-1 (]: 1 of 1 START seed file wellbefore.BuyBox_raw_ds_first20_entries ................ [RUN]
[0m18:52:52.143686 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.buy_box_gcp.BuyBox_raw_ds_first20_entries'
[0m18:52:52.144682 [debug] [Thread-1 (]: Began compiling node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:52:52.144682 [debug] [Thread-1 (]: Began executing node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:52:52.176644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:59.291204 [debug] [Thread-1 (]: On seed.buy_box_gcp.BuyBox_raw_ds_first20_entries: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "seed.buy_box_gcp.BuyBox_raw_ds_first20_entries"} */

    alter table `dbtproject-439612`.`wellbefore`.`BuyBox_raw_ds_first20_entries` set OPTIONS()
  
[0m18:52:59.888350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5d3bcefa-191a-425c-8199-525bcd22501f&page=queryresults
[0m18:53:01.327231 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.buy_box_gcp.BuyBox_raw_ds_first20_entries"
[0m18:53:01.365199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff93168-353c-4813-b0d8-270799bccbdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22A9796A0>]}
[0m18:53:01.366677 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file wellbefore.BuyBox_raw_ds_first20_entries ............ [[32mINSERT 20[0m in 9.22s]
[0m18:53:01.367685 [debug] [Thread-1 (]: Finished running node seed.buy_box_gcp.BuyBox_raw_ds_first20_entries
[0m18:53:01.368684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:01.369686 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:53:01.369686 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:53:01.369686 [debug] [MainThread]: Connection 'seed.buy_box_gcp.BuyBox_raw_ds_first20_entries' was properly closed.
[0m18:53:01.369686 [info ] [MainThread]: 
[0m18:53:01.370683 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 11.78 seconds (11.78s).
[0m18:53:01.371685 [debug] [MainThread]: Command end result
[0m18:53:01.413835 [info ] [MainThread]: 
[0m18:53:01.414838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:01.415832 [info ] [MainThread]: 
[0m18:53:01.416832 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:01.418835 [debug] [MainThread]: Command `dbt seed` succeeded at 18:53:01.418835 after 13.59 seconds
[0m18:53:01.419837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23F9C55E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22CBF9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22CB051F0>]}
[0m18:53:01.419837 [debug] [MainThread]: Flushing usage events
[0m18:53:06.918850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D33B62900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D367CD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D367CC530>]}


============================== 18:53:06.921850 | e0c2cd48-d846-4728-9780-48e01d0f1d51 ==============================
[0m18:53:06.921850 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:53:06.922850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_offer_change_trigger', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:08.270924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D4968C8F0>]}
[0m18:53:08.333039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3420A750>]}
[0m18:53:08.334022 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:53:08.341032 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:53:08.476201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:08.477219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:08.505193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D49E51F10>]}
[0m18:53:08.587656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D4A0535C0>]}
[0m18:53:08.588165 [info ] [MainThread]: Found 1 seed, 6 models, 478 macros
[0m18:53:08.589175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D495CC830>]}
[0m18:53:08.590174 [info ] [MainThread]: 
[0m18:53:08.591175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:53:08.592174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m18:53:08.593172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:09.971643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m18:53:09.971643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:11.293482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D49CC0F20>]}
[0m18:53:11.293482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:11.294925 [info ] [MainThread]: 
[0m18:53:11.298889 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m18:53:11.298889 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_offer_change_trigger ................ [RUN]
[0m18:53:11.299890 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_offer_change_trigger'
[0m18:53:11.300896 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m18:53:11.311239 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m18:53:11.313319 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m18:53:11.344426 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m18:53:11.346423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:11.384213 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m18:53:13.003359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:fff89a51-51f3-4ad0-b1bf-b6a39b3c1ba8&page=queryresults
[0m18:53:13.891668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c2cd48-d846-4728-9780-48e01d0f1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D492E8110>]}
[0m18:53:13.891668 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_offer_change_trigger ........... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m18:53:13.893903 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m18:53:13.895957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:13.895957 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m18:53:13.895957 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m18:53:13.896984 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_offer_change_trigger' was properly closed.
[0m18:53:13.896984 [info ] [MainThread]: 
[0m18:53:13.897900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m18:53:13.898900 [debug] [MainThread]: Command end result
[0m18:53:13.936322 [info ] [MainThread]: 
[0m18:53:13.936875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:13.937883 [info ] [MainThread]: 
[0m18:53:13.938952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:13.939883 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:13.939883 after 7.13 seconds
[0m18:53:13.940992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3634E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D49636D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D365B8530>]}
[0m18:53:13.940992 [debug] [MainThread]: Flushing usage events
[0m12:49:50.256506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF336F2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF336F2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF336F2540>]}


============================== 12:49:50.269044 | d97a6c70-f4be-4d55-947e-2b20b16c5c6d ==============================
[0m12:49:50.269044 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:49:50.269044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:49:52.980795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd97a6c70-f4be-4d55-947e-2b20b16c5c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF337344D0>]}
[0m12:49:53.043855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd97a6c70-f4be-4d55-947e-2b20b16c5c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF332C9730>]}
[0m12:49:53.043855 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:49:53.060482 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 5 files added, 0 files changed.
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_offers.sql
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_shipping.sql
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_products.sql
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_sales_ranking.sql
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_sellers.sql
[0m12:49:53.206493 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp://models\src\src_orders.sql
[0m12:49:53.405947 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.buy_box_gcp.src_sales_ranking' (models\src\src_sales_ranking.sql) depends on a source named 'de-coe.BB_Raw_data' which was not found
[0m12:49:53.421678 [debug] [MainThread]: Command `dbt run` failed at 12:49:53.421678 after 3.32 seconds
[0m12:49:53.421678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF334602C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF31261A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF46DA23C0>]}
[0m12:49:53.421678 [debug] [MainThread]: Flushing usage events
[0m12:51:14.908827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DB63650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DB637D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DB636B0>]}


============================== 12:51:14.908827 | 0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e ==============================
[0m12:51:14.908827 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:51:14.908827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:16.193051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA1047C80>]}
[0m12:51:16.256643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DA92240>]}
[0m12:51:16.256643 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:51:16.256643 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:51:16.392669 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 5 files added, 0 files changed.
[0m12:51:16.408272 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_sales_ranking.sql
[0m12:51:16.408272 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_shipping.sql
[0m12:51:16.408272 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_products.sql
[0m12:51:16.408272 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_offers.sql
[0m12:51:16.408272 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\src_sellers.sql
[0m12:51:16.408272 [debug] [MainThread]: Partial parsing: deleted file: buy_box_gcp://models\src\src_orders.sql
[0m12:51:16.613160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA151CF20>]}
[0m12:51:16.736022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA158F5C0>]}
[0m12:51:16.736022 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m12:51:16.736022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA11728A0>]}
[0m12:51:16.736022 [info ] [MainThread]: 
[0m12:51:16.736022 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:51:16.747630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m12:51:16.748417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:18.341492 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m12:51:18.341492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:19.676191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA151D250>]}
[0m12:51:19.676191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:19.676191 [info ] [MainThread]: 
[0m12:51:19.696341 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m12:51:19.697510 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m12:51:19.697510 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m12:51:19.697510 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m12:51:19.697510 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m12:51:19.697510 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m12:51:19.728924 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m12:51:19.728924 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:19.777530 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m12:51:21.290175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:43f4f8b5-3b33-44b5-ab66-8e0683354472&page=queryresults
[0m12:51:22.247870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8D277740>]}
[0m12:51:22.247870 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.55s]
[0m12:51:22.247870 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m12:51:22.247870 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m12:51:22.247870 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m12:51:22.247870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notification_lowest_prices)
[0m12:51:22.247870 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m12:51:22.247870 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m12:51:22.262884 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m12:51:22.267211 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m12:51:22.269214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:22.293928 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m12:51:23.608296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:03695cf5-77fb-4ed6-a4af-85477dd1b807&page=queryresults
[0m12:51:24.491593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA1409880>]}
[0m12:51:24.491593 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m12:51:24.491593 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m12:51:24.491593 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m12:51:24.491593 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m12:51:24.491593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_lowest_prices, now model.buy_box_gcp.src_notification_summary)
[0m12:51:24.491593 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m12:51:24.506861 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m12:51:24.507682 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m12:51:24.513042 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m12:51:24.513042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:24.551817 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary) AS summary,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS bp

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m12:51:26.025657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:85d5ee5a-6af8-4689-a5c3-64a0ee450f88&page=queryresults
[0m12:51:26.433125 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: lp at [34:16]; reason: invalidQuery, location: query, message: Unrecognized name: lp at [34:16]')
[0m12:51:27.939419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:79656e5e-e64d-4e58-8d59-42902dddae66&page=queryresults
[0m12:51:28.366718 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:79656e5e-e64d-4e58-8d59-42902dddae66&page=queryresults
[0m12:51:28.391605 [debug] [Thread-1 (]: Database Error in model src_notification_summary (models\src\src_notification_summary.sql)
  Unrecognized name: lp at [34:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_summary.sql
[0m12:51:28.391605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA1561520>]}
[0m12:51:28.393983 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model wellbefore.src_notification_summary ...... [[31mERROR[0m in 3.90s]
[0m12:51:28.394992 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m12:51:28.394992 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m12:51:28.396805 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m12:51:28.396805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_summary, now model.buy_box_gcp.src_notifications)
[0m12:51:28.396805 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m12:51:28.396805 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m12:51:28.396805 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m12:51:28.396805 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m12:51:28.396805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:28.448191 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m12:51:29.837604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ddb7ba41-4889-424f-8e55-d1e57b2e1517&page=queryresults
[0m12:51:30.714620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA2A92930>]}
[0m12:51:30.714620 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.32s]
[0m12:51:30.714620 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m12:51:30.714620 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m12:51:30.721808 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m12:51:30.721808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_offer_change_trigger)
[0m12:51:30.721808 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m12:51:30.721808 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m12:51:30.721808 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m12:51:30.729610 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m12:51:30.732938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:30.771021 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m12:51:32.188063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:1af9eac1-b03c-48e4-a57c-8e3c32a36fc0&page=queryresults
[0m12:51:33.052323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA2AA1F10>]}
[0m12:51:33.052323 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m12:51:33.052323 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m12:51:33.052323 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m12:51:33.052323 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m12:51:33.052323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offer_change_trigger, now model.buy_box_gcp.src_offers)
[0m12:51:33.068435 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m12:51:33.071125 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m12:51:33.071125 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m12:51:33.077960 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m12:51:33.077960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:33.112456 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offer,
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        row_number() over(partition by asin order by NotificationId desc) as OfferID,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.SellerId)AS SellerId,
        JSON_VALUE(offer.IsBuyBoxWinner)AS IsBuyBoxWinner,
        JSON_VALUE(offer.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(offer.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        JSON_VALUE(offer.PrimeInformation.IsOfferNationalPrime)AS IsOfferNationalPrime,
        JSON_VALUE(offer.PrimeInformation.IsOfferPrime)AS PrimeInformation,
    FROM flatten_data,
        UNNEST(offer) AS offer
)

SELECT * FROM flatten_data_1;


[0m12:51:34.571223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:283a26a2-79a1-42f1-85cf-317b975d5d88&page=queryresults
[0m12:51:34.985809 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: asin at [21:40]; reason: invalidQuery, location: query, message: Unrecognized name: asin at [21:40]')
[0m12:51:35.825722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0eb9d370-e967-4ec8-b942-80d2ed1f3564&page=queryresults
[0m12:51:36.268897 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0eb9d370-e967-4ec8-b942-80d2ed1f3564&page=queryresults
[0m12:51:36.273915 [debug] [Thread-1 (]: Database Error in model src_offers (models\src\src_offers.sql)
  Unrecognized name: asin at [21:40]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m12:51:36.273915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA2AC4C50>]}
[0m12:51:36.273915 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model wellbefore.src_offers .................... [[31mERROR[0m in 3.22s]
[0m12:51:36.278727 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m12:51:36.279109 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m12:51:36.280117 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m12:51:36.282023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offers, now model.buy_box_gcp.src_products)
[0m12:51:36.282023 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m12:51:36.287926 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m12:51:36.287926 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m12:51:36.294512 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m12:51:36.296536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:36.337695 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m12:51:37.773000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ccb1b148-3b26-4b01-963b-49b965dc4ad0&page=queryresults
[0m12:51:38.210455 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: offer at [20:20]; reason: invalidQuery, location: query, message: Unrecognized name: offer at [20:20]')
[0m12:51:39.149692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:58f18489-2e14-4178-a518-ff2146432ab1&page=queryresults
[0m12:51:39.605208 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:58f18489-2e14-4178-a518-ff2146432ab1&page=queryresults
[0m12:51:39.605208 [debug] [Thread-1 (]: Database Error in model src_products (models\src\src_products.sql)
  Unrecognized name: offer at [20:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_products.sql
[0m12:51:39.605208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA1213FE0>]}
[0m12:51:39.605208 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model wellbefore.src_products .................. [[31mERROR[0m in 3.32s]
[0m12:51:39.605208 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m12:51:39.616989 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sales_ranking
[0m12:51:39.618084 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m12:51:39.618701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_products, now model.buy_box_gcp.src_sales_ranking)
[0m12:51:39.618701 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sales_ranking
[0m12:51:39.620511 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sales_ranking"
[0m12:51:39.620511 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sales_ranking
[0m12:51:39.628902 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sales_ranking"
[0m12:51:39.630024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:39.665344 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sales_ranking"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(offer, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(offer, '$.Rank') AS Rank

    FROM flatten_payload, UNNEST(SalesRankings) AS offer 
)
SELECT * FROM flatten_offers;


[0m12:51:41.456393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:4357d4a2-c651-46ae-bf1b-e3b3b0a66f2c&page=queryresults
[0m12:51:42.333716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA1565640>]}
[0m12:51:42.349289 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.72s]
[0m12:51:42.349289 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sales_ranking
[0m12:51:42.349289 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sellers
[0m12:51:42.349289 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m12:51:42.349289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sales_ranking, now model.buy_box_gcp.src_sellers)
[0m12:51:42.349289 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sellers
[0m12:51:42.349289 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sellers"
[0m12:51:42.349289 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sellers
[0m12:51:42.349289 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sellers"
[0m12:51:42.364818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:42.398293 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sellers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.EventTime) AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
),
SELECT
    EventTime,
    JSON_VALUE(offers.SellerId) AS SellerId,
    JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
    JSON_VALUE(offers.SellerId) AS offer.value:"IsFulfilledByAmazon"::BOOLEAN as IsFulfilledByAmazon
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m12:51:43.775934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3ece5bd8-d439-44fa-acd8-725e66b98bda&page=queryresults
[0m12:51:43.775934 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]')
[0m12:51:44.325240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0f24b83f-07e4-4d27-8a37-f2c0165165db&page=queryresults
[0m12:51:44.340730 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0f24b83f-07e4-4d27-8a37-f2c0165165db&page=queryresults
[0m12:51:44.340730 [debug] [Thread-1 (]: Database Error in model src_sellers (models\src\src_sellers.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]
  compiled Code at target\run\buy_box_gcp\models\src\src_sellers.sql
[0m12:51:44.340730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA2AB5F10>]}
[0m12:51:44.340730 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model wellbefore.src_sellers ................... [[31mERROR[0m in 1.99s]
[0m12:51:44.340730 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sellers
[0m12:51:44.340730 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_shipping
[0m12:51:44.353457 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m12:51:44.354711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sellers, now model.buy_box_gcp.src_shipping)
[0m12:51:44.354711 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_shipping
[0m12:51:44.360372 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_shipping"
[0m12:51:44.362908 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_shipping
[0m12:51:44.362908 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_shipping"
[0m12:51:44.362908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:44.397789 [debug] [Thread-1 (]: On model.buy_box_gcp.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_shipping"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
),
SELECT
    NotificationId,
    EventTime,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.Shipping.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.Shipping.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.Shipping.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m12:51:45.690539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2c0799b3-af3c-4634-a3b3-70b5dac3196a&page=queryresults
[0m12:51:45.692061 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]')
[0m12:51:46.511702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ff30746d-85ff-4c5f-a842-269a5992ef4f&page=queryresults
[0m12:51:46.513031 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ff30746d-85ff-4c5f-a842-269a5992ef4f&page=queryresults
[0m12:51:46.519156 [debug] [Thread-1 (]: Database Error in model src_shipping (models\src\src_shipping.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]
  compiled Code at target\run\buy_box_gcp\models\src\src_shipping.sql
[0m12:51:46.519156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b67447c-76b2-4d7c-ab22-9e9f86d2cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAA2A95CD0>]}
[0m12:51:46.519156 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model wellbefore.src_shipping ................. [[31mERROR[0m in 2.16s]
[0m12:51:46.519156 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_shipping
[0m12:51:46.527247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:46.528351 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m12:51:46.528351 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m12:51:46.528351 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_shipping' was properly closed.
[0m12:51:46.529327 [info ] [MainThread]: 
[0m12:51:46.530294 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 29.79 seconds (29.79s).
[0m12:51:46.533327 [debug] [MainThread]: Command end result
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.561894 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.561894 [error] [MainThread]:   Database Error in model src_notification_summary (models\src\src_notification_summary.sql)
  Unrecognized name: lp at [34:16]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_summary.sql
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.561894 [error] [MainThread]:   Database Error in model src_offers (models\src\src_offers.sql)
  Unrecognized name: asin at [21:40]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.561894 [error] [MainThread]:   Database Error in model src_products (models\src\src_products.sql)
  Unrecognized name: offer at [20:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_products.sql
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.561894 [error] [MainThread]:   Database Error in model src_sellers (models\src\src_sellers.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]
  compiled Code at target\run\buy_box_gcp\models\src\src_sellers.sql
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.561894 [error] [MainThread]:   Database Error in model src_shipping (models\src\src_shipping.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [18:1]
  compiled Code at target\run\buy_box_gcp\models\src\src_shipping.sql
[0m12:51:46.561894 [info ] [MainThread]: 
[0m12:51:46.575903 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=5 SKIP=0 TOTAL=10
[0m12:51:46.578064 [debug] [MainThread]: Command `dbt run` failed at 12:51:46.578064 after 31.85 seconds
[0m12:51:46.579062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8D7A4F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8D7591F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8D758FE0>]}
[0m12:51:46.579062 [debug] [MainThread]: Flushing usage events
[0m15:23:36.429735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024732FC8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002472F7E54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024735A933B0>]}


============================== 15:23:36.429735 | 5b7f138b-4232-4204-9903-e8a07f42f8d3 ==============================
[0m15:23:36.429735 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:23:36.434744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m15:23:37.907033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024748665700>]}
[0m15:23:37.970365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024734ABC980>]}
[0m15:23:37.970365 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:23:37.985967 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:23:38.119567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m15:23:38.119567 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_sellers.sql
[0m15:23:38.119567 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_offers.sql
[0m15:23:38.119567 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_shipping.sql
[0m15:23:38.119567 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_summary.sql
[0m15:23:38.119567 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_products.sql
[0m15:23:38.367083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024749067440>]}
[0m15:23:38.439734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247494228A0>]}
[0m15:23:38.439734 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:23:38.439734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247491389E0>]}
[0m15:23:38.439734 [info ] [MainThread]: 
[0m15:23:38.439734 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:23:38.439734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:23:38.439734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:39.991581 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:23:39.991581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:41.280719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247335525A0>]}
[0m15:23:41.280719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:41.280719 [info ] [MainThread]: 
[0m15:23:41.296214 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m15:23:41.296214 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m15:23:41.296214 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m15:23:41.300150 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m15:23:41.305137 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m15:23:41.305137 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m15:23:41.339700 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m15:23:41.339700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:41.379526 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m15:23:42.948600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:b7a3698d-73ab-4e02-9152-05a07285cd03&page=queryresults
[0m15:23:43.819309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247351A7650>]}
[0m15:23:43.819309 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.52s]
[0m15:23:43.819309 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m15:23:43.819309 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m15:23:43.819309 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m15:23:43.819309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notification_lowest_prices)
[0m15:23:43.819309 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m15:23:43.819309 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m15:23:43.819309 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m15:23:43.834947 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m15:23:43.837800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:43.871841 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m15:23:45.562232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:65200052-31a3-4339-b42a-e001490db09f&page=queryresults
[0m15:23:46.459789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247494B91C0>]}
[0m15:23:46.459789 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.64s]
[0m15:23:46.459789 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m15:23:46.459789 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m15:23:46.459789 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m15:23:46.459789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_lowest_prices, now model.buy_box_gcp.src_notification_summary)
[0m15:23:46.459789 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m15:23:46.477046 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m15:23:46.478163 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m15:23:46.483059 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m15:23:46.485159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:46.521491 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data 32 (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(buyboxprice) AS lp
)

SELECT * FROM flatten_data_1;


[0m15:23:47.785727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:1fc95dc4-261e-4ae4-acd2-ed984175c3e7&page=queryresults
[0m15:23:47.785727 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got integer literal "32" at [6:23]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword AS but got integer literal "32" at [6:23]')
[0m15:23:49.127195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:12714583-14ee-421f-978c-e5d42354964e&page=queryresults
[0m15:23:49.129656 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:12714583-14ee-421f-978c-e5d42354964e&page=queryresults
[0m15:23:49.143221 [debug] [Thread-1 (]: Database Error in model src_notification_summary (models\src\src_notification_summary.sql)
  Syntax error: Expected keyword AS but got integer literal "32" at [6:23]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_summary.sql
[0m15:23:49.143221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024749595F10>]}
[0m15:23:49.143221 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model wellbefore.src_notification_summary ...... [[31mERROR[0m in 2.68s]
[0m15:23:49.146901 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m15:23:49.147514 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m15:23:49.147514 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m15:23:49.150055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_summary, now model.buy_box_gcp.src_notifications)
[0m15:23:49.150055 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m15:23:49.155190 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m15:23:49.156719 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m15:23:49.161275 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m15:23:49.161275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:49.208040 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m15:23:50.768193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5eaab50e-adee-460f-b519-eadec0f45a90&page=queryresults
[0m15:23:51.599428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474A9CAF60>]}
[0m15:23:51.599428 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m15:23:51.599428 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m15:23:51.599428 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m15:23:51.599428 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m15:23:51.599428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_offer_change_trigger)
[0m15:23:51.615029 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m15:23:51.615029 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m15:23:51.615029 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m15:23:51.615029 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m15:23:51.615029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:51.658333 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m15:23:53.148963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3cd43d1a-0697-42e9-8ea7-72283ed73033&page=queryresults
[0m15:23:53.996042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474A9F4DA0>]}
[0m15:23:53.996042 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m15:23:53.996042 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m15:23:53.996042 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m15:23:53.996042 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m15:23:53.996042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offer_change_trigger, now model.buy_box_gcp.src_offers)
[0m15:23:53.996042 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m15:23:53.996042 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m15:23:53.996042 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m15:23:54.016004 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m15:23:54.016004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:54.057744 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offer,
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        row_number() over(partition by asin order by NotificationId desc) as OfferID,
        ASIN,
        JSON_VALUE(offer.SellerId)AS SellerId,
        JSON_VALUE(offer.IsBuyBoxWinner)AS IsBuyBoxWinner,
        JSON_VALUE(offer.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(offer.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        JSON_VALUE(offer.PrimeInformation.IsOfferNationalPrime)AS IsOfferNationalPrime,
        JSON_VALUE(offer.PrimeInformation.IsOfferPrime)AS PrimeInformation,
    FROM flatten_data,
        UNNEST(offer) AS offer
)

SELECT * FROM flatten_data_1;


[0m15:23:55.485970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5f9cda84-20c6-4c1f-90c4-d59767491288&page=queryresults
[0m15:23:55.906342 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: offer at [15:20]; reason: invalidQuery, location: query, message: Unrecognized name: offer at [15:20]')
[0m15:23:57.455052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3445135b-c0bc-4612-b0aa-d099fb4456fc&page=queryresults
[0m15:23:57.825672 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3445135b-c0bc-4612-b0aa-d099fb4456fc&page=queryresults
[0m15:23:57.826438 [debug] [Thread-1 (]: Database Error in model src_offers (models\src\src_offers.sql)
  Unrecognized name: offer at [15:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m15:23:57.826438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024749138B60>]}
[0m15:23:57.826438 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model wellbefore.src_offers .................... [[31mERROR[0m in 3.83s]
[0m15:23:57.826438 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m15:23:57.826438 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m15:23:57.826438 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m15:23:57.826438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offers, now model.buy_box_gcp.src_products)
[0m15:23:57.826438 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m15:23:57.837761 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m15:23:57.839777 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m15:23:57.843785 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m15:23:57.844772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:57.889517 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m15:23:59.199545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c515d557-e0ef-4c26-a70d-a83c3ac44dbf&page=queryresults
[0m15:24:00.099381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247495947D0>]}
[0m15:24:00.099381 [info ] [Thread-1 (]: 7 of 10 OK created sql view model wellbefore.src_products ...................... [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m15:24:00.099381 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m15:24:00.099381 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sales_ranking
[0m15:24:00.099381 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m15:24:00.099381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_products, now model.buy_box_gcp.src_sales_ranking)
[0m15:24:00.099381 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sales_ranking
[0m15:24:00.099381 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sales_ranking"
[0m15:24:00.099381 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sales_ranking
[0m15:24:00.099381 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sales_ranking"
[0m15:24:00.099381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:00.139571 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sales_ranking"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(offer, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(offer, '$.Rank') AS Rank

    FROM flatten_payload, UNNEST(SalesRankings) AS offer 
)
SELECT * FROM flatten_offers;


[0m15:24:01.707389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:cdcd00c6-8ba9-4d7e-93c0-667fc2cb0251&page=queryresults
[0m15:24:03.045784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474AA0D280>]}
[0m15:24:03.045784 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.95s]
[0m15:24:03.045784 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sales_ranking
[0m15:24:03.045784 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sellers
[0m15:24:03.045784 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m15:24:03.045784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sales_ranking, now model.buy_box_gcp.src_sellers)
[0m15:24:03.045784 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sellers
[0m15:24:03.061317 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sellers"
[0m15:24:03.061317 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sellers
[0m15:24:03.061317 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sellers"
[0m15:24:03.061317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:03.105877 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sellers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.EventTime) AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    EventTime,
    JSON_VALUE(offers.SellerId) AS SellerId,
    JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
    JSON_VALUE(offers.SellerId) AS offer.value:"IsFulfilledByAmazon"::BOOLEAN as IsFulfilledByAmazon
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m15:24:04.321720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:0dce08d3-9b37-46e6-91c3-7ae4b2695137&page=queryresults
[0m15:24:04.321720 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got "." at [22:41]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got "." at [22:41]')
[0m15:24:04.831286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:89b3c775-2346-4f50-8cec-c8500014733c&page=queryresults
[0m15:24:04.846879 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:89b3c775-2346-4f50-8cec-c8500014733c&page=queryresults
[0m15:24:04.846879 [debug] [Thread-1 (]: Database Error in model src_sellers (models\src\src_sellers.sql)
  Syntax error: Expected end of input but got "." at [22:41]
  compiled Code at target\run\buy_box_gcp\models\src\src_sellers.sql
[0m15:24:04.846879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474A9F68D0>]}
[0m15:24:04.846879 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model wellbefore.src_sellers ................... [[31mERROR[0m in 1.80s]
[0m15:24:04.846879 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sellers
[0m15:24:04.846879 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_shipping
[0m15:24:04.846879 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m15:24:04.855092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sellers, now model.buy_box_gcp.src_shipping)
[0m15:24:04.855624 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_shipping
[0m15:24:04.858638 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_shipping"
[0m15:24:04.859236 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_shipping
[0m15:24:04.861087 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_shipping"
[0m15:24:04.861087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:04.900300 [debug] [Thread-1 (]: On model.buy_box_gcp.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_shipping"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    NotificationId,
    EventTime,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.Shipping.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.Shipping.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.Shipping.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m15:24:06.346844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:009c532c-895d-44bf-9339-9c710ff2d05f&page=queryresults
[0m15:24:06.773039 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: EventTime at [20:5]; reason: invalidQuery, location: query, message: Unrecognized name: EventTime at [20:5]')
[0m15:24:07.782633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d67b0429-5ad6-411e-a519-751676710b5b&page=queryresults
[0m15:24:08.242251 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d67b0429-5ad6-411e-a519-751676710b5b&page=queryresults
[0m15:24:08.242251 [debug] [Thread-1 (]: Database Error in model src_shipping (models\src\src_shipping.sql)
  Unrecognized name: EventTime at [20:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_shipping.sql
[0m15:24:08.242251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b7f138b-4232-4204-9903-e8a07f42f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474A9DFEF0>]}
[0m15:24:08.242251 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model wellbefore.src_shipping ................. [[31mERROR[0m in 3.39s]
[0m15:24:08.254575 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_shipping
[0m15:24:08.255858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:08.255858 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:24:08.255858 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:24:08.255858 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_shipping' was properly closed.
[0m15:24:08.255858 [info ] [MainThread]: 
[0m15:24:08.255858 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 29.82 seconds (29.82s).
[0m15:24:08.255858 [debug] [MainThread]: Command end result
[0m15:24:08.294308 [info ] [MainThread]: 
[0m15:24:08.294308 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m15:24:08.294308 [info ] [MainThread]: 
[0m15:24:08.294308 [error] [MainThread]:   Database Error in model src_notification_summary (models\src\src_notification_summary.sql)
  Syntax error: Expected keyword AS but got integer literal "32" at [6:23]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_summary.sql
[0m15:24:08.294308 [info ] [MainThread]: 
[0m15:24:08.304881 [error] [MainThread]:   Database Error in model src_offers (models\src\src_offers.sql)
  Unrecognized name: offer at [15:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m15:24:08.307121 [info ] [MainThread]: 
[0m15:24:08.308133 [error] [MainThread]:   Database Error in model src_sellers (models\src\src_sellers.sql)
  Syntax error: Expected end of input but got "." at [22:41]
  compiled Code at target\run\buy_box_gcp\models\src\src_sellers.sql
[0m15:24:08.308334 [info ] [MainThread]: 
[0m15:24:08.308334 [error] [MainThread]:   Database Error in model src_shipping (models\src\src_shipping.sql)
  Unrecognized name: EventTime at [20:5]
  compiled Code at target\run\buy_box_gcp\models\src\src_shipping.sql
[0m15:24:08.308334 [info ] [MainThread]: 
[0m15:24:08.308334 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m15:24:08.308334 [debug] [MainThread]: Command `dbt run` failed at 15:24:08.308334 after 32.07 seconds
[0m15:24:08.308334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024735804EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247356852B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247356850D0>]}
[0m15:24:08.308334 [debug] [MainThread]: Flushing usage events
[0m15:27:57.922777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236750FA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023677BD0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023677E63680>]}


============================== 15:27:57.922777 | 4dcd1f42-7485-4fad-acd5-9643cfe1cc3c ==============================
[0m15:27:57.922777 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:27:57.922777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:27:59.223703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B327950>]}
[0m15:27:59.286600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367592A090>]}
[0m15:27:59.286600 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:27:59.302333 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:27:59.426067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:27:59.426067 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_shipping.sql
[0m15:27:59.426067 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_offers.sql
[0m15:27:59.426067 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_summary.sql
[0m15:27:59.441708 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_sellers.sql
[0m15:27:59.645862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B452D20>]}
[0m15:27:59.725331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B73F7A0>]}
[0m15:27:59.731598 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:27:59.731598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B514620>]}
[0m15:27:59.731598 [info ] [MainThread]: 
[0m15:27:59.731598 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:27:59.731598 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:27:59.731598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:01.324630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:28:01.324630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:02.645574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B867C20>]}
[0m15:28:02.645574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:02.645574 [info ] [MainThread]: 
[0m15:28:02.645574 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m15:28:02.645574 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m15:28:02.645574 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m15:28:02.654812 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m15:28:02.663861 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m15:28:02.663861 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m15:28:02.694981 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m15:28:02.694981 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:02.740947 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m15:28:04.273371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:77e82c6f-8276-40e7-926d-5cf81bf2774e&page=queryresults
[0m15:28:05.152016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360A9887A0>]}
[0m15:28:05.152016 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m15:28:05.167529 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m15:28:05.167529 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m15:28:05.167529 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m15:28:05.167529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notification_lowest_prices)
[0m15:28:05.167529 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m15:28:05.167529 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m15:28:05.167529 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m15:28:05.167529 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m15:28:05.178921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:05.212429 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lp
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lp) AS lp
)

SELECT * FROM flatten_data_1;


[0m15:28:06.671905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:faa0bff8-8972-48c9-a71c-2bb6ca9696b4&page=queryresults
[0m15:28:07.504881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B903170>]}
[0m15:28:07.504881 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m15:28:07.504881 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m15:28:07.504881 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m15:28:07.504881 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m15:28:07.504881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_lowest_prices, now model.buy_box_gcp.src_notification_summary)
[0m15:28:07.504881 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m15:28:07.504881 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m15:28:07.504881 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m15:28:07.523639 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m15:28:07.524441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:07.561033 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(buyboxprice) AS lp
)

SELECT * FROM flatten_data_1;


[0m15:28:09.025863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:e806e087-e55a-43b1-a859-ea0ebab1b513&page=queryresults
[0m15:28:09.934791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B98DA00>]}
[0m15:28:09.934791 [info ] [Thread-1 (]: 3 of 10 OK created sql view model wellbefore.src_notification_summary .......... [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m15:28:09.934791 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m15:28:09.934791 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m15:28:09.934791 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m15:28:09.934791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_summary, now model.buy_box_gcp.src_notifications)
[0m15:28:09.934791 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m15:28:09.953919 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m15:28:09.963078 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m15:28:09.963078 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m15:28:09.963078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:10.002428 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m15:28:11.470982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:db2ff08c-55ac-4e2e-b955-967762069605&page=queryresults
[0m15:28:12.507641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B999820>]}
[0m15:28:12.507641 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.57s]
[0m15:28:12.520660 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m15:28:12.522021 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m15:28:12.522021 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m15:28:12.522021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_offer_change_trigger)
[0m15:28:12.522021 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m15:28:12.522021 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m15:28:12.522021 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m15:28:12.522021 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m15:28:12.522021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:12.560516 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m15:28:14.112751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ef18db9e-bfd1-48a6-8fd1-e5361639163f&page=queryresults
[0m15:28:14.936601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B9CFF20>]}
[0m15:28:14.936601 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m15:28:14.936601 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m15:28:14.936601 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m15:28:14.936601 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m15:28:14.936601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offer_change_trigger, now model.buy_box_gcp.src_offers)
[0m15:28:14.936601 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m15:28:14.949878 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m15:28:14.951224 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m15:28:14.959950 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m15:28:14.961378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:14.995712 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offer,
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        row_number() over(partition by asin order by NotificationId desc) as OfferID,
        ASIN,
        JSON_VALUE(offer.SellerId)AS SellerId,
        JSON_VALUE(offer.IsBuyBoxWinner)AS IsBuyBoxWinner,
        JSON_VALUE(offer.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(offer.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        JSON_VALUE(offer.PrimeInformation.IsOfferNationalPrime)AS IsOfferNationalPrime,
        JSON_VALUE(offer.PrimeInformation.IsOfferPrime)AS PrimeInformation,
    FROM flatten_data,UNNEST(offer) AS offer
)

SELECT * FROM flatten_data_1;


[0m15:28:16.474748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:64e5ce7e-f9eb-48d7-9595-630204c3bd12&page=queryresults
[0m15:28:16.914534 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: offer at [15:20]; reason: invalidQuery, location: query, message: Unrecognized name: offer at [15:20]')
[0m15:28:17.790017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8ceaa41f-3001-4f81-9258-052e7681c4d8&page=queryresults
[0m15:28:18.183974 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8ceaa41f-3001-4f81-9258-052e7681c4d8&page=queryresults
[0m15:28:18.183974 [debug] [Thread-1 (]: Database Error in model src_offers (models\src\src_offers.sql)
  Unrecognized name: offer at [15:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m15:28:18.199590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B9D2150>]}
[0m15:28:18.200465 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model wellbefore.src_offers .................... [[31mERROR[0m in 3.25s]
[0m15:28:18.201706 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m15:28:18.201706 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m15:28:18.201706 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m15:28:18.201706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offers, now model.buy_box_gcp.src_products)
[0m15:28:18.201706 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m15:28:18.201706 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m15:28:18.201706 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m15:28:18.211846 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m15:28:18.211846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:18.245725 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS noo,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS bop
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(bop) AS bop,
        UNNEST(noo) AS noo
)

SELECT * FROM flatten_data_1;


[0m15:28:19.641211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:71659b9f-56d1-4caf-9ee1-afb0f55f9d65&page=queryresults
[0m15:28:20.487534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B9811C0>]}
[0m15:28:20.487534 [info ] [Thread-1 (]: 7 of 10 OK created sql view model wellbefore.src_products ...................... [[32mCREATE VIEW (0 processed)[0m in 2.29s]
[0m15:28:20.501620 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m15:28:20.501620 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sales_ranking
[0m15:28:20.501620 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m15:28:20.503636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_products, now model.buy_box_gcp.src_sales_ranking)
[0m15:28:20.503636 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sales_ranking
[0m15:28:20.507490 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sales_ranking"
[0m15:28:20.507490 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sales_ranking
[0m15:28:20.515011 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sales_ranking"
[0m15:28:20.517202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:20.561376 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sales_ranking"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(offer, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(offer, '$.Rank') AS Rank

    FROM flatten_payload, UNNEST(SalesRankings) AS offer 
)
SELECT * FROM flatten_offers;


[0m15:28:22.023394 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:73d98a11-a6b3-44c9-b218-895a50865222&page=queryresults
[0m15:28:22.948552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B97BF50>]}
[0m15:28:22.948552 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.44s]
[0m15:28:22.948552 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sales_ranking
[0m15:28:22.948552 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sellers
[0m15:28:22.948552 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m15:28:22.948552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sales_ranking, now model.buy_box_gcp.src_sellers)
[0m15:28:22.948552 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sellers
[0m15:28:22.964032 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sellers"
[0m15:28:22.967369 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sellers
[0m15:28:22.971651 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sellers"
[0m15:28:22.971651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:23.012169 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sellers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.EventTime) AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    EventTime,
    JSON_VALUE(offers.SellerId) AS SellerId,
    JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
    JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m15:28:24.391798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:413a6181-70e3-40be-a3b0-98d8d1190ab0&page=queryresults
[0m15:28:25.252962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360CDC0740>]}
[0m15:28:25.252962 [info ] [Thread-1 (]: 9 of 10 OK created sql view model wellbefore.src_sellers ....................... [[32mCREATE VIEW (0 processed)[0m in 2.30s]
[0m15:28:25.252962 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sellers
[0m15:28:25.252962 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_shipping
[0m15:28:25.252962 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m15:28:25.252962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sellers, now model.buy_box_gcp.src_shipping)
[0m15:28:25.252962 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_shipping
[0m15:28:25.252962 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_shipping"
[0m15:28:25.252962 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_shipping
[0m15:28:25.252962 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_shipping"
[0m15:28:25.269655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:25.295731 [debug] [Thread-1 (]: On model.buy_box_gcp.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_shipping"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    NotificationId,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.Shipping.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.Shipping.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.Shipping.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m15:28:26.775539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:d4fdab26-b532-4fa7-9e3c-198e616766b6&page=queryresults
[0m15:28:27.653686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcd1f42-7485-4fad-acd5-9643cfe1cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360CDF1B50>]}
[0m15:28:27.653686 [info ] [Thread-1 (]: 10 of 10 OK created sql view model wellbefore.src_shipping ..................... [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m15:28:27.653686 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_shipping
[0m15:28:27.653686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:27.653686 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:28:27.653686 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:28:27.653686 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_shipping' was properly closed.
[0m15:28:27.653686 [info ] [MainThread]: 
[0m15:28:27.653686 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 27.92 seconds (27.92s).
[0m15:28:27.653686 [debug] [MainThread]: Command end result
[0m15:28:27.701724 [info ] [MainThread]: 
[0m15:28:27.703017 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:28:27.705509 [info ] [MainThread]: 
[0m15:28:27.706029 [error] [MainThread]:   Database Error in model src_offers (models\src\src_offers.sql)
  Unrecognized name: offer at [15:20]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m15:28:27.707025 [info ] [MainThread]: 
[0m15:28:27.707025 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m15:28:27.708024 [debug] [MainThread]: Command `dbt run` failed at 15:28:27.708024 after 29.99 seconds
[0m15:28:27.710825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236779773B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360A99A060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002360B70C650>]}
[0m15:28:27.710825 [debug] [MainThread]: Flushing usage events
[0m15:28:59.824092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382A8A0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382CAA52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382CAA6C30>]}


============================== 15:28:59.824092 | 273e2f9d-97c9-4074-bcfa-4853d5cd4117 ==============================
[0m15:28:59.824092 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:28:59.824092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select src_offers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:01.196014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238408E6330>]}
[0m15:29:01.245416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382CB14C80>]}
[0m15:29:01.245416 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:29:01.261130 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:29:01.395940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:01.395940 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_offers.sql
[0m15:29:01.636681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023840926480>]}
[0m15:29:01.715565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023840D73530>]}
[0m15:29:01.715565 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:29:01.715565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382D09F500>]}
[0m15:29:01.715565 [info ] [MainThread]: 
[0m15:29:01.715565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:01.715565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:29:01.715565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:03.174130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:29:03.174130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:04.473322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382D3A9700>]}
[0m15:29:04.473322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:04.474821 [info ] [MainThread]: 
[0m15:29:04.481316 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m15:29:04.482200 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_offers .............................. [RUN]
[0m15:29:04.484194 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_offers'
[0m15:29:04.484194 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m15:29:04.502487 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m15:29:04.505419 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m15:29:04.529225 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m15:29:04.529225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:04.578558 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;;


[0m15:29:05.919286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3022766e-c24b-4f7d-b368-105fa9ba6723&page=queryresults
[0m15:29:05.919286 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [35:21]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [35:21]')
[0m15:29:07.063347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:14f37cac-2f4f-43ff-836b-82bbf356e2e1&page=queryresults
[0m15:29:07.063347 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:14f37cac-2f4f-43ff-836b-82bbf356e2e1&page=queryresults
[0m15:29:07.079718 [debug] [Thread-1 (]: Database Error in model src_offers (models\src\src_offers.sql)
  Syntax error: Unexpected ";" at [35:21]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m15:29:07.079718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '273e2f9d-97c9-4074-bcfa-4853d5cd4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023840BEB350>]}
[0m15:29:07.079718 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model wellbefore.src_offers ..................... [[31mERROR[0m in 2.60s]
[0m15:29:07.079718 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m15:29:07.093006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:07.094945 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:29:07.095573 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:29:07.095573 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_offers' was properly closed.
[0m15:29:07.095573 [info ] [MainThread]: 
[0m15:29:07.095573 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m15:29:07.095573 [debug] [MainThread]: Command end result
[0m15:29:07.129066 [info ] [MainThread]: 
[0m15:29:07.134054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:29:07.134054 [info ] [MainThread]: 
[0m15:29:07.134054 [error] [MainThread]:   Database Error in model src_offers (models\src\src_offers.sql)
  Syntax error: Unexpected ";" at [35:21]
  compiled Code at target\run\buy_box_gcp\models\src\src_offers.sql
[0m15:29:07.134054 [info ] [MainThread]: 
[0m15:29:07.134054 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:29:07.134054 [debug] [MainThread]: Command `dbt run` failed at 15:29:07.134054 after 7.44 seconds
[0m15:29:07.134054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382A8A0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382AED1A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382CE95D00>]}
[0m15:29:07.134054 [debug] [MainThread]: Flushing usage events
[0m15:29:16.513649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1132DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1132FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1132CE60>]}


============================== 15:29:16.513649 | c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61 ==============================
[0m15:29:16.513649 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:29:16.513649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select src_offers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:17.838268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED249E8710>]}
[0m15:29:17.922441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED104E4CE0>]}
[0m15:29:17.922441 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:29:17.932077 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:29:18.061826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:18.061826 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_offers.sql
[0m15:29:18.281380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED24EE5DC0>]}
[0m15:29:18.359809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED24ED7200>]}
[0m15:29:18.359809 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:29:18.359809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED24EE3710>]}
[0m15:29:18.359809 [info ] [MainThread]: 
[0m15:29:18.359809 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:18.359809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:29:18.375428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:19.673535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:29:19.673535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:21.006572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED24B64770>]}
[0m15:29:21.006572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:21.006572 [info ] [MainThread]: 
[0m15:29:21.006572 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m15:29:21.006572 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_offers .............................. [RUN]
[0m15:29:21.006572 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_offers'
[0m15:29:21.018921 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m15:29:21.020283 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m15:29:21.020283 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m15:29:21.047250 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m15:29:21.047250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:21.093172 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;


[0m15:29:22.641575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5a4e4939-8e9d-449c-a820-917c9cceafd6&page=queryresults
[0m15:29:23.602798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d5ed5b-b3d1-4b51-828b-dc43a7d04c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED23FD8650>]}
[0m15:29:23.602798 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_offers ......................... [[32mCREATE VIEW (0 processed)[0m in 2.60s]
[0m15:29:23.602798 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m15:29:23.602798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:23.602798 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:29:23.602798 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:29:23.618418 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_offers' was properly closed.
[0m15:29:23.618418 [info ] [MainThread]: 
[0m15:29:23.619292 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m15:29:23.620470 [debug] [MainThread]: Command end result
[0m15:29:23.664097 [info ] [MainThread]: 
[0m15:29:23.668423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:23.668979 [info ] [MainThread]: 
[0m15:29:23.669828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:29:23.672223 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:23.672019 after 7.27 seconds
[0m15:29:23.672415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1108AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED24C2D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0E439130>]}
[0m15:29:23.672973 [debug] [MainThread]: Flushing usage events
[0m15:42:23.901000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22B40DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22B40DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22B40DE80>]}


============================== 15:42:23.901000 | aec212e0-8af3-4759-b78c-af29f0a6fd5d ==============================
[0m15:42:23.901000 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:42:23.901000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select src_offers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:25.421206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23E1D9F70>]}
[0m15:42:25.468505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23E41F500>]}
[0m15:42:25.468505 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:42:25.484243 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:42:25.634091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m15:42:25.634091 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_lowest_prices.sql
[0m15:42:25.635093 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_products.sql
[0m15:42:25.635093 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_offers.sql
[0m15:42:25.635093 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_sales_ranking.sql
[0m15:42:25.635093 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_summary.sql
[0m15:42:25.636092 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_buybox_offers.sql
[0m15:42:25.885643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23EE28FB0>]}
[0m15:42:25.967174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23EF57620>]}
[0m15:42:25.967174 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:42:25.967174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23EE13680>]}
[0m15:42:25.967174 [info ] [MainThread]: 
[0m15:42:25.979090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:25.980099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:42:25.981098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:27.313541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:42:27.313541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:28.659310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23EE83110>]}
[0m15:42:28.659310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:28.659310 [info ] [MainThread]: 
[0m15:42:28.677072 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m15:42:28.677072 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_offers .............................. [RUN]
[0m15:42:28.677072 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_offers'
[0m15:42:28.679554 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m15:42:28.681499 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m15:42:28.681499 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m15:42:28.714412 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m15:42:28.714412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:28.746684 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;


[0m15:42:30.213899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:88db35df-9771-4981-a72e-0c38fa6afd02&page=queryresults
[0m15:42:31.114102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec212e0-8af3-4759-b78c-af29f0a6fd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23E0786E0>]}
[0m15:42:31.129136 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_offers ......................... [[32mCREATE VIEW (0 processed)[0m in 2.44s]
[0m15:42:31.130858 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m15:42:31.130858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:31.130858 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:42:31.130858 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:42:31.130858 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_offers' was properly closed.
[0m15:42:31.130858 [info ] [MainThread]: 
[0m15:42:31.130858 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m15:42:31.136374 [debug] [MainThread]: Command end result
[0m15:42:31.181497 [info ] [MainThread]: 
[0m15:42:31.181497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:31.181497 [info ] [MainThread]: 
[0m15:42:31.181497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:31.181497 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:31.181497 after 7.50 seconds
[0m15:42:31.181497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23EBE26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22B5A7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22B5A79E0>]}
[0m15:42:31.181497 [debug] [MainThread]: Flushing usage events
[0m15:42:47.946314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002951244A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002951244A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002951244A5D0>]}


============================== 15:42:47.946314 | c1a4a150-7a61-4548-80e9-48e3eda5eb26 ==============================
[0m15:42:47.946314 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:42:47.946314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:49.431593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029511880AA0>]}
[0m15:42:49.481111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295256E93A0>]}
[0m15:42:49.496507 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:42:49.500710 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:42:49.632436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:42:49.632436 [debug] [MainThread]: Partial parsing: added file: buy_box_gcp://models\src\sources.yml
[0m15:42:49.697406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295260EC950>]}
[0m15:42:49.821029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029525F5A2D0>]}
[0m15:42:49.821029 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:42:49.822028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002951042E6C0>]}
[0m15:42:49.824119 [info ] [MainThread]: 
[0m15:42:49.825025 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:49.829131 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:42:49.830145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:51.063563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:42:51.063563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:52.357146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029525CDD430>]}
[0m15:42:52.358145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:52.358145 [info ] [MainThread]: 
[0m15:42:52.363619 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m15:42:52.365053 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m15:42:52.366065 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m15:42:52.367064 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m15:42:52.376782 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m15:42:52.380773 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m15:42:52.414782 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m15:42:52.414782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:52.466134 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1;


[0m15:42:53.919800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:83240c90-e831-4069-bd22-13738b415de9&page=queryresults
[0m15:42:54.821025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295253784A0>]}
[0m15:42:54.822017 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m15:42:54.822932 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m15:42:54.822932 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m15:42:54.822932 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m15:42:54.823931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notification_lowest_prices)
[0m15:42:54.823931 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m15:42:54.826013 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m15:42:54.827119 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m15:42:54.831055 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m15:42:54.832172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:54.865746 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1;


[0m15:42:56.266317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:284f6993-4467-4763-a8c9-ef70cc3aa080&page=queryresults
[0m15:42:57.130765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029527552F00>]}
[0m15:42:57.130765 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m15:42:57.130765 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m15:42:57.130765 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m15:42:57.130765 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m15:42:57.146549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_lowest_prices, now model.buy_box_gcp.src_notification_summary)
[0m15:42:57.147988 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m15:42:57.147988 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m15:42:57.147988 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m15:42:57.147988 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m15:42:57.147988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:57.197599 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1;


[0m15:42:58.952946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5e08fe85-1996-4d99-ac62-e53a079b00d6&page=queryresults
[0m15:42:59.353496 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name ShippingCost at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name ShippingCost at [6:6]')
[0m15:43:00.962816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8b92f57e-279d-4ad7-9182-14dad8903313&page=queryresults
[0m15:43:01.367392 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8b92f57e-279d-4ad7-9182-14dad8903313&page=queryresults
[0m15:43:01.367392 [debug] [Thread-1 (]: Database Error in model src_notification_summary (models\src\src_notification_summary.sql)
  CREATE VIEW has columns with duplicate name ShippingCost at [6:6]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_summary.sql
[0m15:43:01.367392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029527563380>]}
[0m15:43:01.379785 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model wellbefore.src_notification_summary ...... [[31mERROR[0m in 4.22s]
[0m15:43:01.380871 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m15:43:01.381720 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m15:43:01.384273 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m15:43:01.385980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_summary, now model.buy_box_gcp.src_notifications)
[0m15:43:01.386051 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m15:43:01.391671 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m15:43:01.393662 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m15:43:01.396446 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m15:43:01.398601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:01.432538 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m15:43:02.882027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:a6e5afa8-f4ea-4862-97f6-3403c788e634&page=queryresults
[0m15:43:03.714525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952755AEA0>]}
[0m15:43:03.714525 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m15:43:03.714525 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m15:43:03.719491 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m15:43:03.719491 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m15:43:03.719491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_offer_change_trigger)
[0m15:43:03.722015 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m15:43:03.723033 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m15:43:03.726812 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m15:43:03.731922 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m15:43:03.733922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:03.781549 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m15:43:05.399826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:9fe611da-4c0a-4c8b-b993-ce787f14c6f7&page=queryresults
[0m15:43:06.181458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295276524E0>]}
[0m15:43:06.182073 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m15:43:06.183216 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m15:43:06.184313 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m15:43:06.184979 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m15:43:06.186106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offer_change_trigger, now model.buy_box_gcp.src_offers)
[0m15:43:06.186614 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m15:43:06.198929 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m15:43:06.201065 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m15:43:06.205475 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m15:43:06.207022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:06.256832 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;


[0m15:43:07.801565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2797c0ae-6a94-484c-ab73-464b805a35ac&page=queryresults
[0m15:43:08.698653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952755C5F0>]}
[0m15:43:08.699918 [info ] [Thread-1 (]: 6 of 10 OK created sql view model wellbefore.src_offers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m15:43:08.700961 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m15:43:08.701972 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m15:43:08.701972 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m15:43:08.702972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offers, now model.buy_box_gcp.src_products)
[0m15:43:08.703970 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m15:43:08.710255 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m15:43:08.713230 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m15:43:08.718327 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m15:43:08.720298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:08.782387 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
),

SELECT * FROM flatten_data;


[0m15:43:10.130568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:1c783c54-8f58-46fa-9a7e-27dd08e50353&page=queryresults
[0m15:43:10.130568 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]; reason: invalidQuery, location: query, message: Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]')
[0m15:43:11.007069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2fca09f5-30dc-4986-8627-c4bab5206e6d&page=queryresults
[0m15:43:11.008038 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:2fca09f5-30dc-4986-8627-c4bab5206e6d&page=queryresults
[0m15:43:11.008038 [debug] [Thread-1 (]: Database Error in model src_products (models\src\src_products.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled Code at target\run\buy_box_gcp\models\src\src_products.sql
[0m15:43:11.008038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029527543EF0>]}
[0m15:43:11.008038 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model wellbefore.src_products .................. [[31mERROR[0m in 2.31s]
[0m15:43:11.008038 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m15:43:11.021168 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sales_ranking
[0m15:43:11.021743 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m15:43:11.022753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_products, now model.buy_box_gcp.src_sales_ranking)
[0m15:43:11.023753 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sales_ranking
[0m15:43:11.025036 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sales_ranking"
[0m15:43:11.025036 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sales_ranking
[0m15:43:11.032262 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sales_ranking"
[0m15:43:11.032868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.066456 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sales_ranking"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers;


[0m15:43:12.445067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:40d1b42a-0ac7-4cf4-873a-49d37068be0e&page=queryresults
[0m15:43:13.264459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295275437A0>]}
[0m15:43:13.264459 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m15:43:13.264459 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sales_ranking
[0m15:43:13.264459 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sellers
[0m15:43:13.264459 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m15:43:13.264459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sales_ranking, now model.buy_box_gcp.src_sellers)
[0m15:43:13.264459 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sellers
[0m15:43:13.264459 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sellers"
[0m15:43:13.280087 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sellers
[0m15:43:13.283978 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sellers"
[0m15:43:13.286309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:13.315880 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sellers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sellers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.EventTime) AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    EventTime,
    JSON_VALUE(offers.SellerId) AS SellerId,
    JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
    JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m15:43:14.687026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:914a4001-a5a7-41d1-96ff-753874204c19&page=queryresults
[0m15:43:15.543368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952761CD40>]}
[0m15:43:15.558962 [info ] [Thread-1 (]: 9 of 10 OK created sql view model wellbefore.src_sellers ....................... [[32mCREATE VIEW (0 processed)[0m in 2.28s]
[0m15:43:15.558962 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sellers
[0m15:43:15.558962 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_shipping
[0m15:43:15.558962 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m15:43:15.558962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sellers, now model.buy_box_gcp.src_shipping)
[0m15:43:15.558962 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_shipping
[0m15:43:15.558962 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_shipping"
[0m15:43:15.558962 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_shipping
[0m15:43:15.577568 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_shipping"
[0m15:43:15.580592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:15.614528 [debug] [Thread-1 (]: On model.buy_box_gcp.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_shipping"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_shipping`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
    FROM source_data
)
SELECT
    NotificationId,
    JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
    JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
    JSON_VALUE(offers.Shipping.AvailabilityType) AS ShippingAvailabilityType,
    JSON_VALUE(offers.Shipping.MaximumHours) AS ShippingMaximumHours,
    JSON_VALUE(offers.Shipping.MinimumHours) AS ShippingMinimumHours,
    JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
FROM
    flatten_data, UNNEST(offers) AS offers;


[0m15:43:16.962005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:762a84dd-8575-41dd-b054-c9775d01f8a3&page=queryresults
[0m15:43:17.873397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a4a150-7a61-4548-80e9-48e3eda5eb26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952767B350>]}
[0m15:43:17.874407 [info ] [Thread-1 (]: 10 of 10 OK created sql view model wellbefore.src_shipping ..................... [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m15:43:17.875423 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_shipping
[0m15:43:17.876449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:17.876449 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:43:17.876449 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:43:17.876449 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_shipping' was properly closed.
[0m15:43:17.877468 [info ] [MainThread]: 
[0m15:43:17.877468 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 28.05 seconds (28.05s).
[0m15:43:17.879544 [debug] [MainThread]: Command end result
[0m15:43:17.916222 [info ] [MainThread]: 
[0m15:43:17.916222 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:43:17.916222 [info ] [MainThread]: 
[0m15:43:17.916222 [error] [MainThread]:   Database Error in model src_notification_summary (models\src\src_notification_summary.sql)
  CREATE VIEW has columns with duplicate name ShippingCost at [6:6]
  compiled Code at target\run\buy_box_gcp\models\src\src_notification_summary.sql
[0m15:43:17.916222 [info ] [MainThread]: 
[0m15:43:17.916222 [error] [MainThread]:   Database Error in model src_products (models\src\src_products.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled Code at target\run\buy_box_gcp\models\src\src_products.sql
[0m15:43:17.916222 [info ] [MainThread]: 
[0m15:43:17.916222 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m15:43:17.916222 [debug] [MainThread]: Command `dbt run` failed at 15:43:17.916222 after 30.11 seconds
[0m15:43:17.916222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029525DD61E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029525E3B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029511EFF500>]}
[0m15:43:17.916222 [debug] [MainThread]: Flushing usage events
[0m15:44:14.101260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16A592900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16CDE2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16D143500>]}


============================== 15:44:14.101260 | 550ae386-d1dc-494e-8201-5ddd0661e4c9 ==============================
[0m15:44:14.101260 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:44:14.101260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select src_notification_summary', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:15.531876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16D16EF90>]}
[0m15:44:15.598542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16C4E1580>]}
[0m15:44:15.598542 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:44:15.615264 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:44:15.767186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:44:15.767804 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_notification_summary.sql
[0m15:44:16.000223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1007723F0>]}
[0m15:44:16.076393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E100B833E0>]}
[0m15:44:16.076393 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:44:16.076393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E100BB04D0>]}
[0m15:44:16.076393 [info ] [MainThread]: 
[0m15:44:16.076393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:44:16.076393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:44:16.076393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:17.303824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:44:17.319312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:18.615807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E100813E00>]}
[0m15:44:18.616806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:18.618176 [info ] [MainThread]: 
[0m15:44:18.619185 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m15:44:18.619185 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_notification_summary ................ [RUN]
[0m15:44:18.619185 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_notification_summary'
[0m15:44:18.619185 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m15:44:18.628320 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m15:44:18.628320 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m15:44:18.658928 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m15:44:18.665221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:44:18.702036 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1;


[0m15:44:20.157079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:a381b796-30ae-40a3-aa7b-3e95e8fde035&page=queryresults
[0m15:44:21.037699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550ae386-d1dc-494e-8201-5ddd0661e4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FC58920>]}
[0m15:44:21.037699 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_notification_summary ........... [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m15:44:21.048227 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m15:44:21.049245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:21.050234 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:44:21.050234 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:44:21.050234 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_notification_summary' was properly closed.
[0m15:44:21.051340 [info ] [MainThread]: 
[0m15:44:21.052233 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m15:44:21.053234 [debug] [MainThread]: Command end result
[0m15:44:21.086254 [info ] [MainThread]: 
[0m15:44:21.086254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:21.086254 [info ] [MainThread]: 
[0m15:44:21.086254 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:44:21.086254 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:21.086254 after 7.16 seconds
[0m15:44:21.086254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E100680620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1005BBF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16D187B30>]}
[0m15:44:21.086254 [debug] [MainThread]: Flushing usage events
[0m15:44:39.893859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9AE4D4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9AB5B4A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9AEB30530>]}


============================== 15:44:39.893859 | 954b5ddc-033c-497e-9852-6a4b07d82322 ==============================
[0m15:44:39.893859 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:44:39.897853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select src_products', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:41.247276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C1B08F80>]}
[0m15:44:41.300066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9AE57AED0>]}
[0m15:44:41.300066 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:44:41.300066 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:44:41.432169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:44:41.432169 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_products.sql
[0m15:44:41.658656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C2533F50>]}
[0m15:44:41.721892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C29D79E0>]}
[0m15:44:41.721892 [info ] [MainThread]: Found 1 seed, 10 models, 478 macros
[0m15:44:41.721892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9ACBBAC30>]}
[0m15:44:41.721892 [info ] [MainThread]: 
[0m15:44:41.721892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:44:41.721892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m15:44:41.737587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:43.605904 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m15:44:43.605904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:44.882006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C28974D0>]}
[0m15:44:44.882006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:44.891021 [info ] [MainThread]: 
[0m15:44:44.891021 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m15:44:44.891021 [info ] [Thread-1 (]: 1 of 1 START sql view model wellbefore.src_products ............................ [RUN]
[0m15:44:44.891021 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_products'
[0m15:44:44.891021 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m15:44:44.899976 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m15:44:44.899976 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m15:44:44.934242 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m15:44:44.934242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:44:44.986426 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data;


[0m15:44:46.411049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:6f26fd48-6403-489c-9a13-6c142a512213&page=queryresults
[0m15:44:47.302270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '954b5ddc-033c-497e-9852-6a4b07d82322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C1AF86B0>]}
[0m15:44:47.302270 [info ] [Thread-1 (]: 1 of 1 OK created sql view model wellbefore.src_products ....................... [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m15:44:47.302270 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m15:44:47.302270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:47.302270 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m15:44:47.302270 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m15:44:47.302270 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_products' was properly closed.
[0m15:44:47.302270 [info ] [MainThread]: 
[0m15:44:47.302270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m15:44:47.302270 [debug] [MainThread]: Command end result
[0m15:44:47.351412 [info ] [MainThread]: 
[0m15:44:47.351412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:47.351412 [info ] [MainThread]: 
[0m15:44:47.351412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:44:47.351412 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:47.351412 after 7.60 seconds
[0m15:44:47.351412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9AF027980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C2594E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9C26C9A60>]}
[0m15:44:47.351412 [debug] [MainThread]: Flushing usage events
[0m13:49:28.621682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04FEFB560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04FEF9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04FEFBC80>]}


============================== 13:49:28.621682 | 05eed919-9c6f-477e-8947-ac16bf5d8ddb ==============================
[0m13:49:28.621682 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:49:28.621682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:49:28.638998 [info ] [MainThread]: dbt version: 1.8.6
[0m13:49:28.638998 [info ] [MainThread]: python version: 3.12.6
[0m13:49:28.638998 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m13:49:28.638998 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:49:29.720263 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m13:49:29.720263 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m13:49:29.720263 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp\dbt_project.yml
[0m13:49:29.720263 [info ] [MainThread]: adapter type: bigquery
[0m13:49:29.720263 [info ] [MainThread]: adapter version: 1.8.2
[0m13:49:29.814293 [info ] [MainThread]: Configuration:
[0m13:49:29.815203 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:49:29.816202 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:29.816767 [info ] [MainThread]: Required dependencies:
[0m13:49:29.816767 [debug] [MainThread]: Executing "git --help"
[0m13:49:29.857177 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:29.857177 [debug] [MainThread]: STDERR: "b''"
[0m13:49:29.857177 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:29.857177 [info ] [MainThread]: Connection:
[0m13:49:29.857177 [info ] [MainThread]:   method: service-account
[0m13:49:29.857177 [info ] [MainThread]:   database: dbtproject-439612
[0m13:49:29.857177 [info ] [MainThread]:   execution_project: dbtproject-439612
[0m13:49:29.857177 [info ] [MainThread]:   schema: wellbefore
[0m13:49:29.857177 [info ] [MainThread]:   location: US
[0m13:49:29.857177 [info ] [MainThread]:   priority: interactive
[0m13:49:29.869897 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:49:29.869897 [info ] [MainThread]:   impersonate_service_account: None
[0m13:49:29.871192 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:49:29.871192 [info ] [MainThread]:   job_retries: 1
[0m13:49:29.871192 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:49:29.871192 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:49:29.871192 [info ] [MainThread]:   timeout_seconds: 300
[0m13:49:29.871192 [info ] [MainThread]:   client_id: None
[0m13:49:29.871192 [info ] [MainThread]:   token_uri: None
[0m13:49:29.871192 [info ] [MainThread]:   dataproc_region: None
[0m13:49:29.871192 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:49:29.871192 [info ] [MainThread]:   gcs_bucket: None
[0m13:49:29.871192 [info ] [MainThread]:   dataproc_batch: None
[0m13:49:29.871192 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:49:29.871192 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:49:29.871192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:29.907138 [debug] [MainThread]: On debug: select 1 as id
[0m13:49:31.271109 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:5fe4376b-36c9-4304-8705-0fbf26f28bce&page=queryresults
[0m13:49:32.243364 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:49:32.243364 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:49:32.243364 [debug] [MainThread]: Command `dbt debug` succeeded at 13:49:32.243364 after 3.81 seconds
[0m13:49:32.243364 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:49:32.243364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06303EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0631AE900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04F080C20>]}
[0m13:49:32.243364 [debug] [MainThread]: Flushing usage events
[0m14:28:40.162508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034E5158B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034E633FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034E6321E0>]}


============================== 14:28:40.162508 | a9224c69-96df-40c4-9e5d-868d9f3dc7f6 ==============================
[0m14:28:40.162508 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:28:40.162508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:41.416259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203618B6B70>]}
[0m14:28:41.476144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034E7016A0>]}
[0m14:28:41.479154 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:28:41.479154 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:28:41.620880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m14:28:41.620880 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\sources.yml
[0m14:28:41.620880 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_sellers.sql
[0m14:28:41.620880 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_products.sql
[0m14:28:41.620880 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_shipping.sql
[0m14:28:41.940132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020361A79730>]}
[0m14:28:42.013697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020361E1B020>]}
[0m14:28:42.013697 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 478 macros
[0m14:28:42.013697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020361CC35C0>]}
[0m14:28:42.013697 [info ] [MainThread]: 
[0m14:28:42.013697 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:28:42.029314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m14:28:42.029314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:43.162312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m14:28:43.162312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:44.317113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034C1C65D0>]}
[0m14:28:44.317113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:44.317113 [info ] [MainThread]: 
[0m14:28:44.332724 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m14:28:44.332724 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m14:28:44.338352 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m14:28:44.338352 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m14:28:44.344472 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m14:28:44.346383 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m14:28:44.373077 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m14:28:44.373077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:44.407544 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1;


[0m14:28:45.686264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:b36b505d-a805-4c22-ae50-2a291c66f006&page=queryresults
[0m14:28:46.496638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020361218680>]}
[0m14:28:46.512381 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m14:28:46.512381 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m14:28:46.512381 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m14:28:46.512381 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m14:28:46.512381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notification_lowest_prices)
[0m14:28:46.512381 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m14:28:46.512381 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m14:28:46.512381 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m14:28:46.512381 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m14:28:46.512381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:46.561171 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1;


[0m14:28:47.783943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:e50b1856-e88f-4115-b67c-48ed14264fac&page=queryresults
[0m14:28:48.598762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020362E6D460>]}
[0m14:28:48.598762 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m14:28:48.598762 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m14:28:48.598762 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m14:28:48.598762 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m14:28:48.598762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_lowest_prices, now model.buy_box_gcp.src_notification_summary)
[0m14:28:48.598762 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m14:28:48.598762 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m14:28:48.614413 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m14:28:48.617359 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m14:28:48.617359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:48.641384 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1;


[0m14:28:49.926641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:7ad1cb2c-7be8-4b5b-ad4a-dde6a7fd8100&page=queryresults
[0m14:28:50.757911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020362EEE5A0>]}
[0m14:28:50.757911 [info ] [Thread-1 (]: 3 of 10 OK created sql view model wellbefore.src_notification_summary .......... [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m14:28:50.757911 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m14:28:50.757911 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m14:28:50.757911 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m14:28:50.757911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_summary, now model.buy_box_gcp.src_notifications)
[0m14:28:50.757911 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m14:28:50.777059 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m14:28:50.778200 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m14:28:50.781376 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m14:28:50.782382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:50.807966 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m14:28:52.141184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:de6441c2-e8f8-4fd2-9580-7834bcf899f3&page=queryresults
[0m14:28:52.974392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020362EE2150>]}
[0m14:28:52.974392 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.22s]
[0m14:28:52.974392 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m14:28:52.974392 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m14:28:52.974392 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m14:28:52.974392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_offer_change_trigger)
[0m14:28:52.974392 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m14:28:52.989966 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m14:28:52.989966 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m14:28:52.989966 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m14:28:52.989966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:53.021677 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m14:28:54.283602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:3fefef23-16d6-4c42-ad44-8fc05fc833a4&page=queryresults
[0m14:28:55.107836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020362F19A00>]}
[0m14:28:55.107836 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m14:28:55.107836 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m14:28:55.107836 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m14:28:55.107836 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m14:28:55.107836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offer_change_trigger, now model.buy_box_gcp.src_offers)
[0m14:28:55.107836 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m14:28:55.107836 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m14:28:55.107836 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m14:28:55.123588 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m14:28:55.123588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:55.157455 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;


[0m14:28:56.439146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:082e41d0-1653-450e-bb08-8c827a2acea6&page=queryresults
[0m14:28:57.239897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020362ED91C0>]}
[0m14:28:57.239897 [info ] [Thread-1 (]: 6 of 10 OK created sql view model wellbefore.src_offers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m14:28:57.239897 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m14:28:57.239897 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m14:28:57.239897 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m14:28:57.239897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offers, now model.buy_box_gcp.src_products)
[0m14:28:57.239897 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m14:28:57.239897 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m14:28:57.239897 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m14:28:57.255526 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m14:28:57.255526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:57.290671 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data;


[0m14:28:58.613765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:825595b1-a5d5-4829-b3b5-a1213fafc6ca&page=queryresults
[0m14:28:58.613765 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:825595b1-a5d5-4829-b3b5-a1213fafc6ca&page=queryresults
[0m14:28:58.618357 [debug] [Thread-1 (]: Database Error in model src_products (models\src\src_products.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_products.sql
[0m14:28:58.618357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020362ED9580>]}
[0m14:28:58.618357 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model wellbefore.src_products .................. [[31mERROR[0m in 1.38s]
[0m14:28:58.618357 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m14:28:58.618357 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sales_ranking
[0m14:28:58.618357 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m14:28:58.618357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_products, now model.buy_box_gcp.src_sales_ranking)
[0m14:28:58.618357 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sales_ranking
[0m14:28:58.634084 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sales_ranking"
[0m14:28:58.634084 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sales_ranking
[0m14:28:58.634084 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sales_ranking"
[0m14:28:58.634084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:58.679833 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sales_ranking"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers;


[0m14:28:59.945471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:814f01bc-afb5-4582-bbcc-93634ec614b8&page=queryresults
[0m14:29:00.781906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036332B860>]}
[0m14:29:00.781906 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m14:29:00.781906 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sales_ranking
[0m14:29:00.781906 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sellers
[0m14:29:00.781906 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m14:29:00.781906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sales_ranking, now model.buy_box_gcp.src_sellers)
[0m14:29:00.781906 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sellers
[0m14:29:00.797520 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sellers"
[0m14:29:00.797520 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sellers
[0m14:29:00.797520 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sellers"
[0m14:29:00.797520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:00.841977 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sellers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sellers`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.EventTime) AS EventTime,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     EventTime,
--     JSON_VALUE(offers.SellerId) AS SellerId,
--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers;


[0m14:29:02.107398 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ed1e7179-fa83-4da0-8a83-66b42d66fdb7&page=queryresults
[0m14:29:02.107398 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:ed1e7179-fa83-4da0-8a83-66b42d66fdb7&page=queryresults
[0m14:29:02.120000 [debug] [Thread-1 (]: Database Error in model src_sellers (models\src\src_sellers.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_sellers.sql
[0m14:29:02.120000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036335EAB0>]}
[0m14:29:02.122606 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model wellbefore.src_sellers ................... [[31mERROR[0m in 1.34s]
[0m14:29:02.124895 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sellers
[0m14:29:02.124895 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_shipping
[0m14:29:02.125883 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m14:29:02.126279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sellers, now model.buy_box_gcp.src_shipping)
[0m14:29:02.126279 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_shipping
[0m14:29:02.126279 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_shipping"
[0m14:29:02.126279 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_shipping
[0m14:29:02.126279 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_shipping"
[0m14:29:02.126279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:02.175957 [debug] [Thread-1 (]: On model.buy_box_gcp.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_shipping"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_shipping`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     NotificationId,
--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        NotificationId,
        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,
        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,
        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,
        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,
        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically

    FROM flatten_payload, UNNEST(offers) AS offer 
)
SELECT * FROM flatten_offers;


[0m14:29:03.425016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8deadbff-138b-45c2-bbb6-17b3cc1e1a50&page=queryresults
[0m14:29:03.425016 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:8deadbff-138b-45c2-bbb6-17b3cc1e1a50&page=queryresults
[0m14:29:03.425016 [debug] [Thread-1 (]: Database Error in model src_shipping (models\src\src_shipping.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_shipping.sql
[0m14:29:03.425016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9224c69-96df-40c4-9e5d-868d9f3dc7f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036333AC90>]}
[0m14:29:03.425016 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model wellbefore.src_shipping ................. [[31mERROR[0m in 1.30s]
[0m14:29:03.425016 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_shipping
[0m14:29:03.425016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:03.425016 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m14:29:03.425016 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m14:29:03.425016 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_shipping' was properly closed.
[0m14:29:03.439871 [info ] [MainThread]: 
[0m14:29:03.440880 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 21.43 seconds (21.43s).
[0m14:29:03.442882 [debug] [MainThread]: Command end result
[0m14:29:03.476920 [info ] [MainThread]: 
[0m14:29:03.476920 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:29:03.476920 [info ] [MainThread]: 
[0m14:29:03.476920 [error] [MainThread]:   Database Error in model src_products (models\src\src_products.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_products.sql
[0m14:29:03.476920 [info ] [MainThread]: 
[0m14:29:03.476920 [error] [MainThread]:   Database Error in model src_sellers (models\src\src_sellers.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_sellers.sql
[0m14:29:03.476920 [info ] [MainThread]: 
[0m14:29:03.476920 [error] [MainThread]:   Database Error in model src_shipping (models\src\src_shipping.sql)
  Access Denied: Table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries: User does not have permission to query table dbt-437212:wellbefore.BuyBox_raw_ds_first20_entries, or perhaps it does not exist.
  compiled Code at target\run\buy_box_gcp\models\src\src_shipping.sql
[0m14:29:03.476920 [info ] [MainThread]: 
[0m14:29:03.476920 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m14:29:03.476920 [debug] [MainThread]: Command `dbt run` failed at 14:29:03.476920 after 23.49 seconds
[0m14:29:03.476920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034E5158B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203612B4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020361CEB0B0>]}
[0m14:29:03.476920 [debug] [MainThread]: Flushing usage events
[0m14:32:10.748768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A36FEA4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A39C5C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A39005EE0>]}


============================== 14:32:10.748768 | 819c39d0-677d-48f2-9af9-a3d00aefe3fa ==============================
[0m14:32:10.748768 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:32:10.748768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:32:11.983269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A37842570>]}
[0m14:32:12.030147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A39E0C980>]}
[0m14:32:12.045775 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:32:12.050376 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:32:12.177697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:32:12.177697 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_sellers.sql
[0m14:32:12.177697 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_products.sql
[0m14:32:12.177697 [debug] [MainThread]: Partial parsing: updated file: buy_box_gcp://models\src\src_shipping.sql
[0m14:32:12.405244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D35E0F0>]}
[0m14:32:12.483796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D152450>]}
[0m14:32:12.483796 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 478 macros
[0m14:32:12.483796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D03A9F0>]}
[0m14:32:12.499420 [info ] [MainThread]: 
[0m14:32:12.499420 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:12.499420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612'
[0m14:32:12.499420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:13.832742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtproject-439612_wellbefore'
[0m14:32:13.832742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:14.868676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D35DFA0>]}
[0m14:32:14.868676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:14.868676 [info ] [MainThread]: 
[0m14:32:14.868676 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_buybox_offers
[0m14:32:14.868676 [info ] [Thread-1 (]: 1 of 10 START sql view model wellbefore.src_buybox_offers ...................... [RUN]
[0m14:32:14.868676 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.buy_box_gcp.src_buybox_offers'
[0m14:32:14.882827 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_buybox_offers
[0m14:32:14.884692 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_buybox_offers"
[0m14:32:14.884692 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_buybox_offers
[0m14:32:14.912826 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_buybox_offers"
[0m14:32:14.912826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:14.956879 [debug] [Thread-1 (]: On model.buy_box_gcp.src_buybox_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_buybox_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_buybox_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,
        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,
        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,

        JSON_VALUE(noo.Condition)AS NumberOfferCondition,
        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,
        JSON_VALUE(noo.OfferCount)AS NumberOfferCount
    FROM flatten_data,
        UNNEST(buyboxprices) AS bop,
        UNNEST(numberOfOffers) AS noo
)

SELECT * FROM flatten_data_1;


[0m14:32:16.373365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:1c1383eb-ea42-496c-8920-93c5001f6581&page=queryresults
[0m14:32:17.220376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4C8EF800>]}
[0m14:32:17.220376 [info ] [Thread-1 (]: 1 of 10 OK created sql view model wellbefore.src_buybox_offers ................. [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m14:32:17.220376 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_buybox_offers
[0m14:32:17.220376 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_lowest_prices
[0m14:32:17.220376 [info ] [Thread-1 (]: 2 of 10 START sql view model wellbefore.src_notification_lowest_prices ......... [RUN]
[0m14:32:17.220376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_buybox_offers, now model.buy_box_gcp.src_notification_lowest_prices)
[0m14:32:17.220376 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_lowest_prices
[0m14:32:17.220376 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m14:32:17.235934 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_lowest_prices
[0m14:32:17.238082 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_lowest_prices"
[0m14:32:17.240174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:17.263350 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_lowest_prices: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_lowest_prices"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_lowest_prices`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(lp.Condition)AS Condition,
        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,

        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,

        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,
    FROM flatten_data,
        UNNEST(lowestPrices) AS lp
)

SELECT * FROM flatten_data_1;


[0m14:32:18.522216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:46fa7cfb-126a-4c01-bc18-ff5970e48069&page=queryresults
[0m14:32:19.340917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D4CCD40>]}
[0m14:32:19.344561 [info ] [Thread-1 (]: 2 of 10 OK created sql view model wellbefore.src_notification_lowest_prices .... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m14:32:19.344561 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_lowest_prices
[0m14:32:19.346144 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notification_summary
[0m14:32:19.346144 [info ] [Thread-1 (]: 3 of 10 START sql view model wellbefore.src_notification_summary ............... [RUN]
[0m14:32:19.346144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_lowest_prices, now model.buy_box_gcp.src_notification_summary)
[0m14:32:19.346144 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notification_summary
[0m14:32:19.353780 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notification_summary"
[0m14:32:19.355213 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notification_summary
[0m14:32:19.358727 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notification_summary"
[0m14:32:19.362011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:19.395347 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notification_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notification_summary"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notification_summary`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,
        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice

    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,
        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,

        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,
        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,
        
        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,
        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,

        ListPriceAmount
        
    FROM flatten_data,
        UNNEST(buyboxprice) AS bp
)

SELECT * FROM flatten_data_1;


[0m14:32:20.718319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:509b2d8a-76ef-4d12-91c7-91b7e7b73fda&page=queryresults
[0m14:32:21.499493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D531E50>]}
[0m14:32:21.499493 [info ] [Thread-1 (]: 3 of 10 OK created sql view model wellbefore.src_notification_summary .......... [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m14:32:21.499493 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notification_summary
[0m14:32:21.499493 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_notifications
[0m14:32:21.499493 [info ] [Thread-1 (]: 4 of 10 START sql view model wellbefore.src_notifications ...................... [RUN]
[0m14:32:21.499493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notification_summary, now model.buy_box_gcp.src_notifications)
[0m14:32:21.499493 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_notifications
[0m14:32:21.517391 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_notifications"
[0m14:32:21.519079 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_notifications
[0m14:32:21.521216 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_notifications"
[0m14:32:21.522300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:21.546568 [debug] [Thread-1 (]: On model.buy_box_gcp.src_notifications: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_notifications"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_notifications`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,
        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,
        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_VALUE(raw_data.NotificationType) AS NotificationType,
        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
FROM source_data
)

SELECT * FROM flatten_data;


[0m14:32:22.754101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:c91b47e8-cf14-4cc4-b2e1-288a26617961&page=queryresults
[0m14:32:23.589535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D539BE0>]}
[0m14:32:23.589535 [info ] [Thread-1 (]: 4 of 10 OK created sql view model wellbefore.src_notifications ................. [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m14:32:23.589535 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_notifications
[0m14:32:23.589535 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offer_change_trigger
[0m14:32:23.589535 [info ] [Thread-1 (]: 5 of 10 START sql view model wellbefore.src_offer_change_trigger ............... [RUN]
[0m14:32:23.589535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_notifications, now model.buy_box_gcp.src_offer_change_trigger)
[0m14:32:23.589535 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offer_change_trigger
[0m14:32:23.589535 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offer_change_trigger"
[0m14:32:23.589535 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offer_change_trigger
[0m14:32:23.604129 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offer_change_trigger"
[0m14:32:23.604129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:23.644322 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offer_change_trigger: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offer_change_trigger"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offer_change_trigger`
  OPTIONS()
  as WITH source_data AS (
    SELECT
        PARSE_JSON(data.message_body) AS raw_data,
        PARSE_JSON(data.message_body).Payload AS offer
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,
        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,
    FROM source_data
)
 
SELECT * FROM flatten_data;


[0m14:32:24.872663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:184283d3-cc9a-4f87-9513-d2b4e1baffde&page=queryresults
[0m14:32:25.688379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4E8A8770>]}
[0m14:32:25.688379 [info ] [Thread-1 (]: 5 of 10 OK created sql view model wellbefore.src_offer_change_trigger .......... [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m14:32:25.688379 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offer_change_trigger
[0m14:32:25.688379 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_offers
[0m14:32:25.688379 [info ] [Thread-1 (]: 6 of 10 START sql view model wellbefore.src_offers ............................. [RUN]
[0m14:32:25.688379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offer_change_trigger, now model.buy_box_gcp.src_offers)
[0m14:32:25.688379 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_offers
[0m14:32:25.694477 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_offers"
[0m14:32:25.694477 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_offers
[0m14:32:25.694477 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_offers"
[0m14:32:25.694477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:25.729299 [debug] [Thread-1 (]: On model.buy_box_gcp.src_offers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_offers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_offers`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.NotificationMetadata.NotificationId") AS NotificationId,
        JSON_VALUE(raw_data, "$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN") AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offer
    FROM source_data
),
flatten_data_1 AS (
    SELECT
        NotificationId,
        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,
        ASIN,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsBuyBoxWinner") AS IsBuyBoxWinner,
        JSON_VALUE(offer, "$.ListingPrice.Amount") AS ListingPriceAmount,
        JSON_VALUE(offer, "$.ListingPrice.CurrencyCode") AS ListingPriceCurrencyCode,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferNationalPrime") AS IsOfferNationalPrime,
        JSON_VALUE(offer, "$.PrimeInformation.IsOfferPrime") AS PrimeInformation
    FROM flatten_data,
    UNNEST(offer) AS offer
)

SELECT * 
FROM flatten_data_1;


[0m14:32:26.960282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:86b153ec-3341-4e5c-8d65-47c3b302524c&page=queryresults
[0m14:32:27.851447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D53DB20>]}
[0m14:32:27.851447 [info ] [Thread-1 (]: 6 of 10 OK created sql view model wellbefore.src_offers ........................ [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m14:32:27.851447 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_offers
[0m14:32:27.851447 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_products
[0m14:32:27.851447 [info ] [Thread-1 (]: 7 of 10 START sql view model wellbefore.src_products ........................... [RUN]
[0m14:32:27.851447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_offers, now model.buy_box_gcp.src_products)
[0m14:32:27.851447 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_products
[0m14:32:27.851447 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_products"
[0m14:32:27.851447 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_products
[0m14:32:27.868211 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_products"
[0m14:32:27.869713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:27.899719 [debug] [Thread-1 (]: On model.buy_box_gcp.src_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_products"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_products`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data,
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,
        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId
    FROM source_data
)
SELECT * FROM flatten_data;


[0m14:32:29.232909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:9f29fb35-c44f-4dd6-bff7-88bb19991b31&page=queryresults
[0m14:32:30.077956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D54A300>]}
[0m14:32:30.077956 [info ] [Thread-1 (]: 7 of 10 OK created sql view model wellbefore.src_products ...................... [[32mCREATE VIEW (0 processed)[0m in 2.23s]
[0m14:32:30.077956 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_products
[0m14:32:30.077956 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sales_ranking
[0m14:32:30.077956 [info ] [Thread-1 (]: 8 of 10 START sql view model wellbefore.src_sales_ranking ...................... [RUN]
[0m14:32:30.077956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_products, now model.buy_box_gcp.src_sales_ranking)
[0m14:32:30.077956 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sales_ranking
[0m14:32:30.077956 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sales_ranking"
[0m14:32:30.077956 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sales_ranking
[0m14:32:30.094684 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sales_ranking"
[0m14:32:30.096817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:30.129670 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sales_ranking: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sales_ranking"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sales_ranking`
  OPTIONS()
  as WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,
        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        ASIN,
        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,
        JSON_EXTRACT(sr, '$.Rank') AS Ranking
    FROM flatten_payload, UNNEST(SalesRankings) AS sr 
)
SELECT * FROM flatten_offers;


[0m14:32:31.598595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:fadaa9cf-c86a-43b2-997d-cec35b229a98&page=queryresults
[0m14:32:32.461589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D507D10>]}
[0m14:32:32.461589 [info ] [Thread-1 (]: 8 of 10 OK created sql view model wellbefore.src_sales_ranking ................. [[32mCREATE VIEW (0 processed)[0m in 2.38s]
[0m14:32:32.461589 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sales_ranking
[0m14:32:32.461589 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_sellers
[0m14:32:32.461589 [info ] [Thread-1 (]: 9 of 10 START sql view model wellbefore.src_sellers ............................ [RUN]
[0m14:32:32.461589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sales_ranking, now model.buy_box_gcp.src_sellers)
[0m14:32:32.461589 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_sellers
[0m14:32:32.476599 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_sellers"
[0m14:32:32.476599 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_sellers
[0m14:32:32.476599 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_sellers"
[0m14:32:32.476599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:32.514371 [debug] [Thread-1 (]: On model.buy_box_gcp.src_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_sellers"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_sellers`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.EventTime) AS EventTime,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     EventTime,
--     JSON_VALUE(offers.SellerId) AS SellerId,
--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,
--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
        PARSE_JSON(data.message_body) AS raw_data
    FROM 
        dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries AS data
),
flatten_data AS (
    SELECT
        JSON_VALUE(raw_data, "$.EventTime") AS EventTime,
        JSON_EXTRACT_ARRAY(raw_data, "$.Payload.AnyOfferChangedNotification.Offers") AS offers
    FROM source_data
),
flattened_offers AS (
    SELECT 
        EventTime,
        JSON_VALUE(offer, "$.SellerId") AS SellerId,
        JSON_VALUE(offer, "$.IsFeaturedMerchant") AS IsFeaturedMerchant,
        JSON_VALUE(offer, "$.IsFulfilledByAmazon") AS IsFulfilledByAmazon
    FROM 
        flatten_data,
        UNNEST(offers) AS offer
)
SELECT * 
FROM flattened_offers;


[0m14:32:33.872911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:71f3cbcf-79fc-45f0-8513-6e1bc34e5a80&page=queryresults
[0m14:32:34.783873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4E8C73E0>]}
[0m14:32:34.783873 [info ] [Thread-1 (]: 9 of 10 OK created sql view model wellbefore.src_sellers ....................... [[32mCREATE VIEW (0 processed)[0m in 2.32s]
[0m14:32:34.799351 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_sellers
[0m14:32:34.799351 [debug] [Thread-1 (]: Began running node model.buy_box_gcp.src_shipping
[0m14:32:34.799351 [info ] [Thread-1 (]: 10 of 10 START sql view model wellbefore.src_shipping .......................... [RUN]
[0m14:32:34.799351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.buy_box_gcp.src_sellers, now model.buy_box_gcp.src_shipping)
[0m14:32:34.799351 [debug] [Thread-1 (]: Began compiling node model.buy_box_gcp.src_shipping
[0m14:32:34.799351 [debug] [Thread-1 (]: Writing injected SQL for node "model.buy_box_gcp.src_shipping"
[0m14:32:34.799351 [debug] [Thread-1 (]: Began executing node model.buy_box_gcp.src_shipping
[0m14:32:34.799351 [debug] [Thread-1 (]: Writing runtime sql for node "model.buy_box_gcp.src_shipping"
[0m14:32:34.814370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:34.844987 [debug] [Thread-1 (]: On model.buy_box_gcp.src_shipping: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "buy_box_gcp", "target_name": "dev", "node_id": "model.buy_box_gcp.src_shipping"} */


  create or replace view `dbtproject-439612`.`wellbefore`.`src_shipping`
  OPTIONS()
  as -- WITH source_data AS (
--     SELECT 
--         PARSE_JSON(data.message_body) AS raw_data,
--     FROM 
--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data
-- ),
-- flatten_data AS (
--     SELECT
--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,
--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers
--     FROM source_data
-- )
-- SELECT
--     NotificationId,
--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,
--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,
--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,
--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,
--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,
--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,
-- FROM
--     flatten_data, UNNEST(offers) AS offers

WITH source_data AS (
    SELECT 
      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,
      PARSE_JSON(data.message_body) as parse_data
    FROM dbtproject-439612.wellbefore.BuyBox_raw_ds_first20_entries as data
),
flatten_payload AS (
    SELECT 
        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,
        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers
    FROM source_data
),
flatten_offers AS (
    SELECT 
        GENERATE_UUID() as SurrogateKey,
        NotificationId,
        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,
        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,
        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,
        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,
        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,
        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically

    FROM flatten_payload, UNNEST(offers) AS offer 
)
SELECT * FROM flatten_offers;


[0m14:32:36.135311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtproject-439612&j=bq:US:7fd93d2e-0823-40f4-9610-02e2405182a9&page=queryresults
[0m14:32:36.993931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819c39d0-677d-48f2-9af9-a3d00aefe3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D520D40>]}
[0m14:32:36.993931 [info ] [Thread-1 (]: 10 of 10 OK created sql view model wellbefore.src_shipping ..................... [[32mCREATE VIEW (0 processed)[0m in 2.19s]
[0m14:32:36.993931 [debug] [Thread-1 (]: Finished running node model.buy_box_gcp.src_shipping
[0m14:32:36.993931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:36.993931 [debug] [MainThread]: Connection 'list_dbtproject-439612' was properly closed.
[0m14:32:36.993931 [debug] [MainThread]: Connection 'list_dbtproject-439612_wellbefore' was properly closed.
[0m14:32:36.993931 [debug] [MainThread]: Connection 'model.buy_box_gcp.src_shipping' was properly closed.
[0m14:32:36.993931 [info ] [MainThread]: 
[0m14:32:36.993931 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 24.49 seconds (24.49s).
[0m14:32:37.010965 [debug] [MainThread]: Command end result
[0m14:32:37.028722 [info ] [MainThread]: 
[0m14:32:37.028722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:37.028722 [info ] [MainThread]: 
[0m14:32:37.028722 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:32:37.028722 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:37.028722 after 26.47 seconds
[0m14:32:37.044936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3932E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D3BD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4D03B0B0>]}
[0m14:32:37.044936 [debug] [MainThread]: Flushing usage events
[0m17:26:42.737459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB6223F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB622720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB623170>]}


============================== 17:26:42.737459 | faa4ee3f-d758-4fe6-95ef-81d1bde24862 ==============================
[0m17:26:42.737459 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:26:42.737459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\SAILS-DM204\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:42.757112 [info ] [MainThread]: dbt version: 1.8.6
[0m17:26:42.758328 [info ] [MainThread]: python version: 3.12.6
[0m17:26:42.758328 [info ] [MainThread]: python path: C:\Users\SAILS-DM204\AppData\Local\Programs\Python\Python312\python.exe
[0m17:26:42.758328 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m17:26:43.959822 [info ] [MainThread]: Using profiles dir at C:\Users\SAILS-DM204\.dbt
[0m17:26:43.959822 [info ] [MainThread]: Using profiles.yml file at C:\Users\SAILS-DM204\.dbt\profiles.yml
[0m17:26:43.959822 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\SAILS-DM204\OneDrive - Sails Software Solutions Pvt Ltd\Desktop\Dummy Folder\buy_box_gcp\dbt_project.yml
[0m17:26:43.959822 [info ] [MainThread]: adapter type: bigquery
[0m17:26:43.959822 [info ] [MainThread]: adapter version: 1.8.2
[0m17:26:44.060084 [info ] [MainThread]: Configuration:
[0m17:26:44.060084 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:26:44.060084 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:26:44.060084 [info ] [MainThread]: Required dependencies:
[0m17:26:44.066805 [debug] [MainThread]: Executing "git --help"
[0m17:26:44.113738 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:26:44.113738 [debug] [MainThread]: STDERR: "b''"
[0m17:26:44.116831 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:26:44.116955 [info ] [MainThread]: Connection:
[0m17:26:44.116955 [info ] [MainThread]:   method: service-account
[0m17:26:44.116955 [info ] [MainThread]:   database: de-coe
[0m17:26:44.116955 [info ] [MainThread]:   execution_project: de-coe
[0m17:26:44.116955 [info ] [MainThread]:   schema: buybox_dataset
[0m17:26:44.116955 [info ] [MainThread]:   location: US
[0m17:26:44.116955 [info ] [MainThread]:   priority: interactive
[0m17:26:44.116955 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:26:44.116955 [info ] [MainThread]:   impersonate_service_account: None
[0m17:26:44.122894 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:26:44.123902 [info ] [MainThread]:   job_retries: 1
[0m17:26:44.123902 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:26:44.124903 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m17:26:44.124903 [info ] [MainThread]:   timeout_seconds: 300
[0m17:26:44.125900 [info ] [MainThread]:   client_id: None
[0m17:26:44.125900 [info ] [MainThread]:   token_uri: None
[0m17:26:44.127042 [info ] [MainThread]:   dataproc_region: None
[0m17:26:44.127042 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:26:44.127042 [info ] [MainThread]:   gcs_bucket: None
[0m17:26:44.127042 [info ] [MainThread]:   dataproc_batch: None
[0m17:26:44.127042 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:26:44.127042 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:26:44.127042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:26:44.166986 [debug] [MainThread]: On debug: select 1 as id
[0m17:26:45.946851 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-coe&j=bq:US:e1b90e38-21d4-45d8-aa55-3ed3740875e7&page=queryresults
[0m17:26:46.906614 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:26:46.906614 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:26:46.906614 [debug] [MainThread]: Command `dbt debug` succeeded at 17:26:46.906614 after 4.37 seconds
[0m17:26:46.906614 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:26:46.906614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB1CD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DE20F200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DE579A60>]}
[0m17:26:46.906614 [debug] [MainThread]: Flushing usage events
